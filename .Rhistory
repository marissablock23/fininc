labels.county$county[labels.county$county=="Lamu"] <- "Lamu, 41.5"
labels.county$county[labels.county$county=="Marsabit"] <- "Marsabit, 43.9"
# Map
finac.k.15 %>%
mutate(nobank = bank_usage - 2) %>%
group_by(county) %>%
filter(nobank==1) %>%
summarize(n = n()) %>%
left_join(pop, by = "county") %>%
mutate(usepcap = (n/pop_2015)*100000) %>%
left_join(kenya, by = "county") %>%
cbind(st_coordinates(st_centroid(kenya))) %>%
mutate(density = n/Shape_Area) %>%
ggplot() +
geom_sf(aes(fill = cut_number(usepcap, 5)), size = 0.2, color = "white") +
geom_label_repel(data = labels.county, aes(X, Y, label = county), size = 3, family = "Avenir Next") +
coord_sf(datum=NA) +
scale_fill_manual(name = NULL, values = c("#f7dfcc", "#efbf99", "#e89f67", "#e07e34", "#d95f02"),
labels = c("Less than 7.72", "7.72-9.74", "9.75-11.4", "11.5-16.9", "17-83.7")) +
my.theme +
theme(panel.background = element_blank(),
axis.title = element_blank()) +
labs(title = "Individuals who have never banked are \nconcentrated in three counties",
subtitle = "Individuals who never banked per 100,000 in 2015",
caption = "Source: 2015-16 Financial Access Survey \n Population data is a projection from UNICEF") +
annotate("text", x = 35, y = -3, label = "Tanzania", family = "Avenir Next", size = 3, hjust = 0) +
annotate("text", x = 32, y = 0.7, label = "Uganda", family = "Avenir Next", size = 3, hjust = 0) +
annotate("text", x = 37.5, y = 5.4, label = "Ethiopia", family = "Avenir Next", size = 3, hjust = 0) +
annotate("text", x = 41.05, y = 1.8, label = "Somalia", family = "Avenir Next", size = 3, hjust =0)
labels.county <- kenya %>%
cbind(st_coordinates(st_centroid(kenya))) %>%
filter(county=="Isiolo" | county=="Lamu" | county=="Marsabit")
labels.county$county[labels.county$county=="Isiolo"] <- "Isiolo, 83.7"
labels.county$county[labels.county$county=="Lamu"] <- "Lamu, 41.5"
labels.county$county[labels.county$county=="Marsabit"] <- "Marsabit, 43.9"
# Map
finac.k.15 %>%
mutate(nobank = bank_usage - 2) %>%
group_by(county) %>%
filter(nobank==1) %>%
summarize(n = n()) %>%
left_join(pop, by = "county") %>%
mutate(usepcap = (n/pop_2015)*100000) %>%
left_join(kenya, by = "county") %>%
cbind(st_coordinates(st_centroid(kenya))) %>%
mutate(density = n/Shape_Area) %>%
ggplot() +
geom_sf(aes(fill = cut_number(usepcap, 5)), size = 0.2, color = "white") +
geom_label_repel(data = labels.county, aes(X, Y, label = county), size = 3, family = "Avenir Next") +
coord_sf(datum=NA) +
scale_fill_manual(name = NULL, values = c("#f7dfcc", "#efbf99", "#e89f67", "#e07e34", "#d95f02"),
labels = c("Less than 7.72", "7.72-9.74", "9.75-11.4", "11.5-16.9", "17-83.7")) +
my.theme +
theme(panel.background = element_blank(),
axis.title = element_blank()) +
labs(title = "Individuals who have never banked are \nconcentrated in three counties",
subtitle = "Individuals who never banked per 100,000 in 2015",
caption = "Source: 2015-16 Financial Access Survey \n Population data is a projection from UNICEF") +
annotate("text", x = 35, y = -3, label = "Tanzania", family = "Avenir Next", size = 3, hjust = 0) +
annotate("text", x = 32, y = 0.7, label = "Uganda", family = "Avenir Next", size = 3, hjust = 0) +
annotate("text", x = 37.5, y = 5.4, label = "Ethiopia", family = "Avenir Next", size = 3, hjust = 0) +
annotate("text", x = 41.05, y = 1.8, label = "Somalia", family = "Avenir Next", size = 3, hjust = 0)
finac.k.15 %>%
mutate(nobank = bank_usage - 2) %>%
group_by(county) %>%
filter(nobank==1) %>%
summarize(n = n()) %>%
left_join(pop, by = "county") %>%
mutate(usepcap = (n/pop_2015)*100000) %>%
ggplot(aes(x = reorder(county, usepcap), y = (usepcap), fill = cut_number(usepcap, 5))) +
geom_bar(stat = "identity") +
scale_fill_manual(name = NULL, values = c("#f7dfcc", "#efbf99", "#e89f67", "#e07e34", "#d95f02"),
labels = c("Less than 7.72", "7.72-9.74", "9.75-11.4", "11.5-16.9", "17-83.7")) +
scale_x_discrete(expand = c(0,0)) +
scale_y_continuous(expand = c(0,0)) +
labs(
x = NULL,
y = NULL,
title = "Unbanked per capita by county"
) +
my.theme +
theme(axis.text.x = element_text(angle = 90, hjust = 1),
axis.line.x.bottom = element_blank(),
axis.ticks.x = element_blank(),
legend.position = c(0.05, 0.97),
legend.justification = c("left", "top"),
legend.box.just = "left",
legend.margin = margin(6, 6, 6, 6),
legend.box.background = element_rect())
## Slope graph
finac.k.06 <- mutate(finac.k.06, year = 2006)
finac.k.06 <- rename(finac.k.06, bank_usage = "A4", savings_usage = "X_savings", credit_usage = "X_credit", mfi_usage = "X_cur_mfi", insurance_usage = "X_useins")
finac.k.15 <- mutate(finac.k.15, year = 2015)
y2006 <- finac.k.06 %>%
select(year, bank_usage, savings_usage, credit_usage, mfi_usage, insurance_usage)
y2015 <- finac.k.15 %>%
select(year, bank_usage, savings_usage, credit_usage, mfi_usage, insurance_usage)
combine <-bind_rows(y2006, y2015)
combine <- combine %>%
rename(Banks = "bank_usage", Savings = "savings_usage", Credit = "credit_usage", Microfinance = "mfi_usage", Insurance = "insurance_usage") %>%
gather(Banks, Savings, Credit, Microfinance, Insurance, key = "type", value = "value") %>%
group_by(year, type) %>%
summarize(total1 = sum(value[value==1]), total2 = n(), pct = (total1/total2)*100)
ggplot(data = combine, aes(x = year, y = pct, group = type)) +
geom_line(aes(color = type, alpha = 1), size = 2) +
geom_point(aes(color = type, alpha = 1), size = 4) +
scale_x_continuous(name = "Year", position = "top", breaks = c(2006, 2015)) +
scale_color_brewer(palette = "Dark2") +
geom_text_repel(data = combine %>% filter(year==2006), aes(label = paste0(type, ":", round(pct, 2), "%")),
hjust = -0.1,
vjust = -1,
family = "Avenir Next",
size = 4) +
geom_text_repel(data = combine %>% filter(year==2015), aes(label = paste0(round(pct, 2), "%")),
hjust = 1,
vjust = -1,
family = "Avenir Next",
size = 4) +
labs(
title = "Commercial banks and savings products have seen the \n largest increase in usage from 2006 to 2015",
subtitle = "Credit and microfinance have hardly changed, \n while insurance has decreased slightly",
caption = "Note: Individuals may have more than one financial product, \n so these numbers do not sum to 100. \n Source: Financial Access Survey, Kenya, 2006 and 2015"
) +
theme(text = element_text(family = "Avenir Next"),
plot.title = element_text(face = "bold"),
plot.subtitle = element_text(face = "italic"),
legend.position = "none",
panel.border = element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
axis.ticks = element_blank())
## Slope graph
finac.k.06 <- mutate(finac.k.06, year = 2006)
finac.k.06 <- rename(finac.k.06, bank_usage = "A4", savings_usage = "X_savings", credit_usage = "X_credit", mfi_usage = "X_cur_mfi", insurance_usage = "X_useins")
## Slope graph
finac.k.06 <- mutate(finac.k.06, year = 2006)
finac.k.06 <- rename(finac.k.06, bank_usage = "A4", savings_usage = "X_savings", credit_usage = "X_credit", mfi_usage = "X_cur_mfi", insurance_usage = "X_useins")
finac.k.06 <- mutate(finac.k.06, year = 2006)
finac.k.06 <- rename(finac.k.06, bank_usage = "A4", savings_usage = "X_savings", credit_usage = "X_credit", mfi_usage = "X_cur_mfi", insurance_usage = "X_useins")
y2006 <- finac.k.06 %>%
select(year, bank_usage, savings_usage, credit_usage, mfi_usage, insurance_usage)
y2015 <- finac.k.15 %>%
select(year, bank_usage, savings_usage, credit_usage, mfi_usage, insurance_usage)
combine <-bind_rows(y2006, y2015)
combine <- combine %>%
rename(Banks = "bank_usage", Savings = "savings_usage", Credit = "credit_usage", Microfinance = "mfi_usage", Insurance = "insurance_usage") %>%
gather(Banks, Savings, Credit, Microfinance, Insurance, key = "type", value = "value") %>%
group_by(year, type) %>%
summarize(total1 = sum(value[value==1]), total2 = n(), pct = (total1/total2)*100)
ggplot(data = combine, aes(x = year, y = pct, group = type)) +
geom_line(aes(color = type, alpha = 1), size = 2) +
geom_point(aes(color = type, alpha = 1), size = 4) +
scale_x_continuous(name = "Year", position = "top", breaks = c(2006, 2015)) +
scale_color_brewer(palette = "Dark2") +
geom_label_repel(data = combine %>% filter(year==2006), aes(label = paste0(type, ":", round(pct, 2), "%")),
hjust = -0.1,
vjust = -1,
family = "Avenir Next",
size = 4) +
geom_label_repel(data = combine %>% filter(year==2015), aes(label = paste0(round(pct, 2), "%")),
hjust = 1,
vjust = -1,
family = "Avenir Next",
size = 4) +
labs(
title = "Commercial banks and savings products have seen the \n largest increase in usage from 2006 to 2015",
subtitle = "Credit and microfinance have hardly changed, \n while insurance has decreased slightly",
caption = "Note: Individuals may have more than one financial product, \n so these numbers do not sum to 100. \n Source: Financial Access Survey, Kenya, 2006 and 2015"
) +
my.theme +
theme(legend.position = "none",
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())
y2006 <- finac.k.06 %>%
select(year, bank_usage, savings_usage, credit_usage, mfi_usage, insurance_usage)
y2015 <- finac.k.15 %>%
select(year, bank_usage, savings_usage, credit_usage, mfi_usage, insurance_usage)
combine <-bind_rows(y2006, y2015)
combine <- combine %>%
rename(Banks = "bank_usage", Savings = "savings_usage", Credit = "credit_usage", Microfinance = "mfi_usage", Insurance = "insurance_usage") %>%
gather(Banks, Savings, Credit, Microfinance, Insurance, key = "type", value = "value") %>%
group_by(year, type) %>%
summarize(total1 = sum(value[value==1]), total2 = n(), pct = (total1/total2)*100)
ggplot(data = combine, aes(x = year, y = pct, group = type)) +
geom_line(aes(color = type, alpha = 1), size = 2) +
geom_point(aes(color = type, alpha = 1), size = 4) +
scale_x_continuous(name = "Year", position = "top", breaks = c(2006, 2015)) +
scale_color_brewer(palette = "Dark2") +
geom_label_repel(data = combine %>% filter(year==2006), aes(label = paste0(type, ":", round(pct, 2), "%")),
hjust = -0.1,
vjust = -1,
family = "Avenir Next",
size = 4) +
geom_label_repel(data = combine %>% filter(year==2015), aes(label = paste0(round(pct, 2), "%")),
hjust = 1,
vjust = -1,
family = "Avenir Next",
size = 4) +
labs(
title = "Commercial banks and savings products have seen the \n largest increase in usage from 2006 to 2015",
subtitle = "Credit and microfinance have hardly changed, \n while insurance has decreased slightly",
caption = "Note: Individuals may have more than one financial product, \n so these numbers do not sum to 100. \n Source: Financial Access Survey, Kenya, 2006 and 2015"
) +
my.theme +
theme(
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())
combine <-bind_rows(y2006, y2015)
combine <- combine %>%
rename(Banks = "bank_usage", Savings = "savings_usage", Credit = "credit_usage", Microfinance = "mfi_usage", Insurance = "insurance_usage") %>%
gather(Banks, Savings, Credit, Microfinance, Insurance, key = "type", value = "value") %>%
group_by(year, type) %>%
summarize(total1 = sum(value[value==1]), total2 = n(), pct = (total1/total2)*100)
ggplot(data = combine, aes(x = year, y = pct, group = type)) +
geom_line(aes(color = type, alpha = 1), size = 2) +
geom_point(aes(color = type, alpha = 1), size = 4) +
scale_x_continuous(name = "Year", position = "top", breaks = c(2006, 2015)) +
scale_color_brewer(name = NULL, palette = "Dark2") +
scale_alpha(name = NULL) +
geom_label_repel(data = combine %>% filter(year==2006), aes(label = paste0(round(pct, 2), "%")),
hjust = -0.1,
vjust = -1,
family = "Avenir Next",
size = 4) +
geom_label_repel(data = combine %>% filter(year==2015), aes(label = paste0(round(pct, 2), "%")),
hjust = 1,
vjust = -1,
family = "Avenir Next",
size = 4) +
labs(
title = "Commercial banks and savings products have seen the \n largest increase in usage from 2006 to 2015",
subtitle = "Credit and microfinance have hardly changed, \n while insurance has decreased slightly",
caption = "Note: Individuals may have more than one financial product, \n so these numbers do not sum to 100. \n Source: Financial Access Survey, Kenya, 2006 and 2015"
) +
my.theme +
theme(
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())
combine <-bind_rows(y2006, y2015)
combine <- combine %>%
rename(Banks = "bank_usage", Savings = "savings_usage", Credit = "credit_usage", Microfinance = "mfi_usage", Insurance = "insurance_usage") %>%
gather(Banks, Savings, Credit, Microfinance, Insurance, key = "type", value = "value") %>%
group_by(year, type) %>%
summarize(total1 = sum(value[value==1]), total2 = n(), pct = (total1/total2)*100)
ggplot(data = combine, aes(x = year, y = pct, group = type)) +
geom_line(aes(color = type), size = 2) +
geom_point(aes(color = type), size = 4) +
scale_x_continuous(name = "Year", position = "top", breaks = c(2006, 2015)) +
scale_color_brewer(name = NULL, palette = "Dark2") +
geom_label_repel(data = combine %>% filter(year==2006), aes(label = paste0(round(pct, 2), "%")),
hjust = -0.1,
vjust = -1,
family = "Avenir Next",
size = 4) +
geom_label_repel(data = combine %>% filter(year==2015), aes(label = paste0(round(pct, 2), "%")),
hjust = 1,
vjust = -1,
family = "Avenir Next",
size = 4) +
labs(
title = "Commercial banks and savings products have seen the \n largest increase in usage from 2006 to 2015",
subtitle = "Credit and microfinance have hardly changed, \n while insurance has decreased slightly",
caption = "Note: Individuals may have more than one financial product, \n so these numbers do not sum to 100. \n Source: Financial Access Survey, Kenya, 2006 and 2015"
) +
my.theme +
theme(
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())
combine <-bind_rows(y2006, y2015)
combine <- combine %>%
rename(Banks = "bank_usage", Savings = "savings_usage", Credit = "credit_usage", Microfinance = "mfi_usage", Insurance = "insurance_usage") %>%
gather(Banks, Savings, Credit, Microfinance, Insurance, key = "type", value = "value") %>%
group_by(year, type) %>%
summarize(total1 = sum(value[value==1]), total2 = n(), pct = (total1/total2)*100) %>%
mutate(type2 = factor(type, levels = c("Savings", "Credit", "Banks", "Insurance", "Microfinance")))
ggplot(data = combine, aes(x = year, y = pct, group = type)) +
geom_line(aes(color = type), size = 2) +
geom_point(aes(color = type), size = 4) +
scale_x_continuous(name = "Year", position = "top", breaks = c(2006, 2015)) +
scale_color_brewer(name = NULL, palette = "Dark2") +
geom_label_repel(data = combine %>% filter(year==2006), aes(label = paste0(round(pct, 2), "%")),
hjust = -0.1,
vjust = -1,
family = "Avenir Next",
size = 4) +
geom_label_repel(data = combine %>% filter(year==2015), aes(label = paste0(round(pct, 2), "%")),
hjust = 1,
vjust = -1,
family = "Avenir Next",
size = 4) +
labs(
title = "Commercial banks and savings products have seen the \n largest increase in usage from 2006 to 2015",
subtitle = "Credit and microfinance have hardly changed, \n while insurance has decreased slightly",
caption = "Note: Individuals may have more than one financial product, \n so these numbers do not sum to 100. \n Source: Financial Access Survey, Kenya, 2006 and 2015"
) +
my.theme +
theme(
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())
combine <-bind_rows(y2006, y2015)
combine <- combine %>%
rename(Banks = "bank_usage", Savings = "savings_usage", Credit = "credit_usage", Microfinance = "mfi_usage", Insurance = "insurance_usage") %>%
gather(Banks, Savings, Credit, Microfinance, Insurance, key = "type", value = "value") %>%
group_by(year, type) %>%
summarize(total1 = sum(value[value==1]), total2 = n(), pct = (total1/total2)*100) %>%
mutate(type2 = factor(type, levels = c("Savings", "Credit", "Banks", "Insurance", "Microfinance")))
ggplot(data = combine, aes(x = year, y = pct, group = type2)) +
geom_line(aes(color = type2), size = 2) +
geom_point(aes(color = type2), size = 4) +
scale_x_continuous(name = "Year", position = "top", breaks = c(2006, 2015)) +
scale_color_brewer(name = NULL, palette = "Dark2") +
geom_label_repel(data = combine %>% filter(year==2006), aes(label = paste0(round(pct, 2), "%")),
hjust = -0.1,
vjust = -1,
family = "Avenir Next",
size = 4) +
geom_label_repel(data = combine %>% filter(year==2015), aes(label = paste0(round(pct, 2), "%")),
hjust = 1,
vjust = -1,
family = "Avenir Next",
size = 4) +
labs(
title = "Commercial banks and savings products have seen the \n largest increase in usage from 2006 to 2015",
subtitle = "Credit and microfinance have hardly changed, \n while insurance has decreased slightly",
caption = "Note: Individuals may have more than one financial product, \n so these numbers do not sum to 100. \n Source: Financial Access Survey, Kenya, 2006 and 2015"
) +
my.theme +
theme(
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())
labels.bubble <-   wdi %>%
filter(year==2016, cntry.code!="SSD") %>%
select(cntry.code, year, ny.gdp.pcap.kd, fr.inr.rinr) %>%
left_join(imf) %>%
select(cntry.code, economy, year, ny.gdp.pcap.kd, fr.inr.rinr, i_depositors_A1_pop, i_deposit_acc_A1_pop, Region) %>%
filter(!is.na(fr.inr.rinr)) %>%
filter(cntry.code %in% c("MDG", "TLS", "BRA", "QAT", "SGP", "KWT", "BRN", "ARG", "SUR", "BWA")) %>%
mutate(label = paste0(economy, ": ", round(i_depositors_A1_pop, 0)))
wdi %>%
filter(year==2016) %>%
select(cntry.code, year, ny.gdp.pcap.kd, fr.inr.rinr) %>%
left_join(imf) %>%
select(cntry.code, year, ny.gdp.pcap.kd, fr.inr.rinr, i_depositors_A1_pop, i_deposit_acc_A1_pop, Region) %>%
filter(!is.na(fr.inr.rinr) & !is.na(ny.gdp.pcap.kd) & !is.na(i_depositors_A1_pop)) %>%
ggplot(aes(x = ny.gdp.pcap.kd, y = fr.inr.rinr, size = i_depositors_A1_pop)) +
geom_point(alpha = 0.5, color = "#1b9e77") +
scale_size_continuous(name = "# of Depositors per\n1,000 adults", range = c(0, 8)) +
scale_x_continuous(labels = scales::comma) +
geom_label_repel(data = labels.bubble, aes(label = label), family = "Avenir Next", size = 3,
show.legend = FALSE, angle = 30, nudge_x = 0.2, box.padding = 0.5) +
labs(
title = "Low savings does not necessarily translate to a high cost of finance",
subtitle = "As measured by the real interest rate, GDP per capita, 2016\n\nValues in labels are # of depositors",
caption = "Source: World Development Indicators, IMF Financial Access Survey, 2016",
y = "Real Interest Rate (%)",
x = "GDP per capita, (constant 2010 US$)"
) +
my.theme +
theme(legend.position = c(0.75, 0.97),
legend.justification = c("left", "top"),
legend.box.just = "left",
legend.margin = margin(6, 6, 6, 6),
legend.box.background = element_rect()) +
annotate("rect", xmin = 0, xmax = 20000, ymin = 38, ymax = 55, alpha = 0.15) +
annotate("text", x = 17000, y = 50, label = "High cost of finance", family = "Avenir Next") +
annotate("rect", xmin = 1000, xmax = 16000, ymin = -18, ymax = -2, alpha = 0.15) +
annotate("text", x = 18000, y = -15, label = "Low cost of finance", family = "Avenir Next")
# Create dataframe of labels - MDG, TLS, BRA, QAT, SGP, KWT, BRN, ARG, SUR
labels.bubble2 <-   wdi %>%
filter(year==2016, cntry.code!="SSD") %>%
select(cntry.code, year, ny.gdp.pcap.kd, fr.inr.rinr) %>%
left_join(imf) %>%
select(cntry.code, economy, year, ny.gdp.pcap.kd, fr.inr.rinr, i_depositors_A1_pop, i_deposit_acc_A1_pop, Region) %>%
filter(!is.na(fr.inr.rinr)) %>%
filter(cntry.code %in% c("MDG", "TLS", "BRA", "ARG", "SUR", "BWA", "CHN", "UGA", "KGZ")) %>%
mutate(label = paste0(economy, ": ", round(i_depositors_A1_pop, 0)))
wdi %>%
filter(year==2016, ny.gdp.pcap.kd<20000) %>%
select(cntry.code, year, ny.gdp.pcap.kd, fr.inr.rinr) %>%
left_join(imf) %>%
select(cntry.code, year, ny.gdp.pcap.kd, fr.inr.rinr, i_depositors_A1_pop, i_deposit_acc_A1_pop, Region) %>%
filter(!is.na(fr.inr.rinr) & !is.na(ny.gdp.pcap.kd) & !is.na(i_depositors_A1_pop)) %>%
ggplot(aes(x = ny.gdp.pcap.kd, y = fr.inr.rinr, size = i_depositors_A1_pop)) +
geom_point(alpha = 0.5, color = "#1b9e77") +
scale_size_continuous(name = "# of Depositors per \n1,000 adults", range = c(0, 8)) +
scale_x_continuous(labels = scales::comma) +
geom_label_repel(data = labels.bubble2, aes(label = label), family = "Avenir Next", size = 3,
show.legend = FALSE, angle = 30, nudge_x = 0.2, box.padding = 0.5) +
labs(
title = "A Closer Look at economies with GDP per capita less than $20,000",
subtitle = "As measured by the real interest rate, GDP per capita",
caption = "Source: World Development Indicators, IMF Financial Access Survey, 2016",
y = "Real Interest Rate (%)",
x = "GDP per capita, (constant 2010 US$)"
) +
my.theme +
theme(legend.position = c(0.77, 0.97),
legend.justification = c("left", "top"),
legend.box.just = "left",
legend.margin = margin(6, 6, 6, 6),
legend.box.background = element_rect())
labels.bubble2 <-   wdi %>%
filter(year==2016, cntry.code!="SSD") %>%
select(cntry.code, year, ny.gdp.pcap.kd, fr.inr.rinr) %>%
left_join(imf) %>%
select(cntry.code, economy, year, ny.gdp.pcap.kd, fr.inr.rinr, i_depositors_A1_pop, i_deposit_acc_A1_pop, Region) %>%
filter(!is.na(fr.inr.rinr)) %>%
filter(cntry.code %in% c("MDG", "TLS", "BRA", "ARG", "SUR", "BWA", "CHN", "UGA", "KGZ")) %>%
mutate(label = paste0(economy, ": ", round(i_depositors_A1_pop, 0)))
wdi %>%
filter(year==2016, ny.gdp.pcap.kd<20000) %>%
select(cntry.code, year, ny.gdp.pcap.kd, fr.inr.rinr) %>%
left_join(imf) %>%
select(cntry.code, year, ny.gdp.pcap.kd, fr.inr.rinr, i_depositors_A1_pop, i_deposit_acc_A1_pop, Region) %>%
filter(!is.na(fr.inr.rinr) & !is.na(ny.gdp.pcap.kd) & !is.na(i_depositors_A1_pop)) %>%
ggplot(aes(x = ny.gdp.pcap.kd, y = fr.inr.rinr, size = i_depositors_A1_pop)) +
geom_point(alpha = 0.5, color = "#1b9e77") +
scale_size_continuous(name = "# of Depositors per \n1,000 adults", range = c(0, 8)) +
scale_x_continuous(labels = scales::comma) +
geom_label_repel(data = labels.bubble2, aes(label = label), family = "Avenir Next", size = 3,
show.legend = FALSE, angle = 30, nudge_x = 0.2, box.padding = 0.5) +
labs(
title = "A Closer Look at economies with GDP per capita less than $20,000",
subtitle = "As measured by the real interest rate, GDP per capita",
caption = "Source: World Development Indicators, IMF Financial Access Survey, 2016",
y = "Real Interest Rate (%)",
x = "GDP per capita, (constant 2010 US$)"
) +
my.theme +
theme(legend.position = c(0.79, 0.97),
legend.justification = c("left", "top"),
legend.box.just = "left",
legend.margin = margin(6, 6, 6, 6),
legend.box.background = element_rect())
labels.bubble2 <-   wdi %>%
filter(year==2016, cntry.code!="SSD") %>%
select(cntry.code, year, ny.gdp.pcap.kd, fr.inr.rinr) %>%
left_join(imf) %>%
select(cntry.code, economy, year, ny.gdp.pcap.kd, fr.inr.rinr, i_depositors_A1_pop, i_deposit_acc_A1_pop, Region) %>%
filter(!is.na(fr.inr.rinr)) %>%
filter(cntry.code %in% c("MDG", "TLS", "BRA", "ARG", "SUR", "BWA", "CHN", "UGA", "KGZ")) %>%
mutate(label = paste0(economy, ": ", round(i_depositors_A1_pop, 0)))
wdi %>%
filter(year==2016, ny.gdp.pcap.kd<20000) %>%
select(cntry.code, year, ny.gdp.pcap.kd, fr.inr.rinr) %>%
left_join(imf) %>%
select(cntry.code, year, ny.gdp.pcap.kd, fr.inr.rinr, i_depositors_A1_pop, i_deposit_acc_A1_pop, Region) %>%
filter(!is.na(fr.inr.rinr) & !is.na(ny.gdp.pcap.kd) & !is.na(i_depositors_A1_pop)) %>%
ggplot(aes(x = ny.gdp.pcap.kd, y = fr.inr.rinr, size = i_depositors_A1_pop)) +
geom_point(alpha = 0.5, color = "#1b9e77") +
scale_size_continuous(name = "# of Depositors per \n1,000 adults", range = c(0, 8)) +
scale_x_continuous(labels = scales::comma) +
geom_label_repel(data = labels.bubble2, aes(label = label), family = "Avenir Next", size = 3,
show.legend = FALSE, angle = 30, nudge_x = 0.2, box.padding = 0.5) +
labs(
title = "A Closer Look at economies with GDP per capita less than $20,000",
subtitle = "As measured by the real interest rate, GDP per capita",
caption = "Source: World Development Indicators, IMF Financial Access Survey, 2016",
y = "Real Interest Rate (%)",
x = "GDP per capita, (constant 2010 US$)"
) +
my.theme +
theme(legend.position = c(0.783, 0.97),
legend.justification = c("left", "top"),
legend.box.just = "left",
legend.margin = margin(6, 6, 6, 6),
legend.box.background = element_rect())
# Countries with GDP < $20,000
# Create dataframe of labels - MDG, TLS, BRA, QAT, SGP, KWT, BRN, ARG, SUR
labels.bubble2 <-   wdi %>%
filter(year==2016, cntry.code!="SSD") %>%
select(cntry.code, year, ny.gdp.pcap.kd, fr.inr.rinr) %>%
left_join(imf) %>%
select(cntry.code, economy, year, ny.gdp.pcap.kd, fr.inr.rinr, i_depositors_A1_pop, i_deposit_acc_A1_pop, Region) %>%
filter(!is.na(fr.inr.rinr)) %>%
filter(cntry.code %in% c("MDG", "TLS", "BRA", "ARG", "SUR", "BWA", "CHN", "UGA", "KGZ")) %>%
mutate(label = paste0(economy, ": ", round(i_depositors_A1_pop, 0)))
wdi %>%
filter(year==2016, ny.gdp.pcap.kd<20000) %>%
select(cntry.code, year, ny.gdp.pcap.kd, fr.inr.rinr) %>%
left_join(imf) %>%
select(cntry.code, year, ny.gdp.pcap.kd, fr.inr.rinr, i_depositors_A1_pop, i_deposit_acc_A1_pop, Region) %>%
filter(!is.na(fr.inr.rinr) & !is.na(ny.gdp.pcap.kd) & !is.na(i_depositors_A1_pop)) %>%
ggplot(aes(x = ny.gdp.pcap.kd, y = fr.inr.rinr, size = i_depositors_A1_pop)) +
geom_point(alpha = 0.5, color = "#1b9e77") +
scale_size_continuous(name = "# of Depositors per \n1,000 adults", range = c(0, 8)) +
scale_x_continuous(labels = scales::comma) +
geom_label_repel(data = labels.bubble2, aes(label = label), family = "Avenir Next", size = 3,
show.legend = FALSE, angle = 30, nudge_x = 0.2, box.padding = 0.5) +
labs(
title = "A Closer Look at economies with GDP per capita less than $20,000",
subtitle = "As measured by the real interest rate, GDP per capita",
caption = "Source: World Development Indicators, IMF Financial Access Survey, 2016",
y = "Real Interest Rate (%)",
x = "GDP per capita, (constant 2010 US$)"
) +
my.theme +
theme(legend.position = c(0.785, 0.97),
legend.justification = c("left", "top"),
legend.box.just = "left",
legend.margin = margin(6, 6, 6, 6),
legend.box.background = element_rect())
