finac.k$e4_4[finac.k$e4_4==2] <- 0
finac.k$e4_5[finac.k$e4_5==2] <- 0
finac.k$e4_7[finac.k$e4_7==2] <- 0
finac.k$e4_9[finac.k$e4_9==2] <- 0
finac.k %>%
select(rural, e4_1, e4_3, e4_4, e4_5, e4_7, e4_9) %>%
group_by(rural) %>%
summarize(sum = sum(e4_1) sum2 = sum(e4_3))
finac.k %>%
select(rural, e4_1, e4_3, e4_4, e4_5, e4_7, e4_9) %>%
group_by(rural) %>%
summarize(sum = sum(e4_1),
sum2 = sum(e4_3))
finac.k %>%
select(rural, e4_1, e4_3, e4_4, e4_5, e4_7, e4_9)
finac.k %>%
#select(rural, e4_1, e4_3, e4_4, e4_5, e4_7, e4_9) %>%
group_by(rural) %>%
summarize(sum = sum(e4_1),
sum2 = sum(e4_3))
table(finac.k$rural)
finac.k %>%
#select(rural, e4_1, e4_3, e4_4, e4_5, e4_7, e4_9) %>%
group_by(rural)
finac.k %>%
#select(rural, e4_1, e4_3, e4_4, e4_5, e4_7, e4_9) %>%
group_by(rural) %>%
summarize(sum = sum(e4_1))
finac.k %>%
#select(rural, e4_1, e4_3, e4_4, e4_5, e4_7, e4_9) %>%
group_by(rural) %>%
summarize(mean = mean(e4_1))
finac.k %>%
#select(rural, e4_1, e4_3, e4_4, e4_5, e4_7, e4_9) %>%
group_by(rural) %>%
table(e4_1)
finac.k %>%
#select(rural, e4_1, e4_3, e4_4, e4_5, e4_7, e4_9) %>%
group_by(rural) %>%
finac.k %>%
#select(rural, e4_1, e4_3, e4_4, e4_5, e4_7, e4_9) %>%
group_by(rural)
finac.k %>%
select(rural, e4_1, e4_3, e4_4, e4_5, e4_7, e4_9) %>%
group_by(rural)
str(finac.k)
table(finac.k$e4_3)
str(finac.k$e4_3)
class(finac.k$e4_3)
finac.k$e4_1 <- as.numeric(finac.k$e4_1)
class(finac.k$e4_1)
finac.k %>%
#select(rural, e4_1, e4_3, e4_4, e4_5, e4_7, e4_9) %>%
group_by(rural) %>%
summarize(mean = mean(e4_1))
class(finac.k$rural)
str(finac.k$rural)
finac.k %>%
select(rural, e4_1, e4_3, e4_4, e4_5, e4_7, e4_9) %>%
group_by(rural)
finac.k %>%
select(rural, e4_1) %>%
group_by(rural)
rlang::last_error()
summary(rlang::last_error())
finac.k %>%
select(rural)
finac.k %>%
group_by(rural) %>%
summarize(mean = mean(total_income))
finac.k <- read_dta("data/fin_access16_kenya.dta")
# Clean variable names
finac.k <- rename(finac.k, sex.res = "gender_of_respondent", rural = "cluster_type")
finac.k %>%
group_by(rural) %>%
summarize(mean = mean(total_income))
class(finac.k$rural)
table(finac.k$rural)
finac.k$area <- 0
finac.k$area[finac.k$rural==2] <- 1
table(finac.k$area)
finac.k %>%
group_by(area) %>%
summarize(mean = mean(total_income))
finac.k %>%
group_by(area)
finac.k %>%
group_by(area) %>%
summarize(mean = mean(total_income))
View(finac.k)
finac.k <- read_dta("data/fin_access16_kenya.dta")
finac.k %>%
group_by(cluster_type) %>%
summarize(mean = mean(total_income))
finac.k %>%
group_by(cluster_type) %>%
summarize(mean = mean(total_income, na.rm = TRUE))
finac.k$e4_1[finac.k$e4_1==2] <- 0
finac.k$e4_3[finac.k$e4_3==2] <- 0
finac.k$e4_4[finac.k$e4_4==2] <- 0
finac.k$e4_5[finac.k$e4_5==2] <- 0
finac.k$e4_7[finac.k$e4_7==2] <- 0
finac.k$e4_9[finac.k$e4_9==2] <- 0
finac.k$e4_1 <- as.numeric(finac.k$e4_1)
finac.k %>%
group_by(cluster_type) %>%
summarize(mean = mean(e4_1, na.rm = TRUE))
finac.k %>%
group_by(cluster_type) %>%
summarize(mean1 = mean(e4_1, na.rm = TRUE),
mean2 = mean(e4_3, na.rm = TRUE))
finac.k %>%
group_by(cluster_type) %>%
summarize(mean1 = mean(e4_1, na.rm = TRUE),
mean2 = mean(e4_3, na.rm = TRUE)) %>%
gather("mean1", "mean2", key = "product", value = "proportion")
1774 + 395
1858-1774
count(finac.k$bank_usage3)
table(finac.k$bank_usage3)
n(finac.k$bank_usage3)
unique(finac.k$bank_usage3)
n_distinctn(finac.k$bank_usage3[finac.k$bank_usage3==3])
n_distinct(finac.k$bank_usage3[finac.k$bank_usage3==3])
count(finac.k$bank_usage3[finac.k$bank_usage3==3])
finac.k %>%
group_by(cluster_type) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE)) %>%
gather("bank", "sacco", "micro", "savings", key = "product", value = "proportion")
finac.k %>%
group_by(cluster_type) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE)) %>%
gather("bank", "sacco", "micro", "savings", key = "product", value = "proportion") %>%
ggplot(aes(x = product, y = cluster_type, fill = proportion)) +
geom_tile()
finac.k %>%
group_by(cluster_type) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE)) %>%
gather("bank", "sacco", "micro", "savings", key = "product", value = "proportion") %>%
ggplot(aes(x = product, y = cluster_type, fill = proportion)) +
geom_tile() +
scale_y_discrete(breaks=c("0", "1"))
finac.k %>%
group_by(cluster_type) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE)) %>%
gather("bank", "sacco", "micro", "savings", key = "product", value = "proportion") %>%
ggplot(aes(x = product, y = as.factor(cluster_type), fill = proportion)) +
geom_tile()
finac.k %>%
group_by(cluster_type education) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE))
finac.k %>%
group_by(cluster_type, education) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE))
finac.k %>%
group_by(cluster_type, education) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE)) %>%
gather("bank", "sacco", "micro", "savings", key = "product", value = "proportion") %>%
ggplot(aes(x = product, y = as.factor(cluster_type), fill = proportion)) +
geom_tile()
finac.k %>%
group_by(cluster_type, education) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE)) %>%
gather("bank", "sacco", "micro", "savings", key = "product", value = "proportion")
finac.k %>%
group_by(cluster_type, education) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE)) %>%
gather("bank", "sacco", "micro", "savings", key = "product", value = "proportion") %>%
mutate(com = "cluster_type"_"education")
finac.k %>%
group_by(cluster_type, education) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE)) %>%
gather("bank", "sacco", "micro", "savings", key = "product", value = "proportion") %>%
mutate(com = n_distinct())
finac.k %>%
group_by(cluster_type, education) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE)) %>%
gather("bank", "sacco", "micro", "savings", key = "product", value = "proportion") %>%
mutate(com = n_distinct(cluster_type, education))
?n_distinct
finac.k %>%
group_by(cluster_type, gender_of_respondent) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE))
finac.k %>%
group_by(cluster_type, gender_of_respondent) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE)) %>%
gather("bank", "sacco", "micro", "savings", key = "product", value = "proportion")
finac.k %>%
group_by(cluster_type, gender_of_respondent) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE)) %>%
gather("bank", "sacco", "micro", "savings", key = "product", value = "proportion") %>%
unite(sex_area, cluster_type, gender_of_respondent)
finac.k %>%
group_by(cluster_type, gender_of_respondent) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE)) %>%
gather("bank", "sacco", "micro", "savings", key = "product", value = "proportion") %>%
unite(sex_area, cluster_type, gender_of_respondent)
ggplot(aes(x = product, y = as.factor(sex_area), fill = proportion)) +
geom_tile()
finac.k %>%
group_by(cluster_type, gender_of_respondent) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE)) %>%
gather("bank", "sacco", "micro", "savings", key = "product", value = "proportion") %>%
unite(sex_area, cluster_type, gender_of_respondent) %>%
ggplot(aes(x = product, y = as.factor(sex_area), fill = proportion)) +
geom_tile()
finac.k %>%
group_by(cluster_type, gender_of_respondent) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE)) %>%
gather("bank", "sacco", "micro", "savings", key = "product", value = "proportion") %>%
unite(sex_area, cluster_type, gender_of_respondent) %>%
ggplot(aes(x = product, y = as.factor(sex_area), fill = proportion)) +
geom_tile(color = "white", size = 0.25)
finac.k %>%
group_by(cluster_type, gender_of_respondent) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE)) %>%
gather("bank", "sacco", "micro", "savings", key = "product", value = "proportion") %>%
unite(sex_area, cluster_type, gender_of_respondent) %>%
ggplot(aes(x = product, y = as.factor(sex_area), fill = proportion)) +
geom_tile(color = "white", size = 0.25) +
labs(
title = "Most Kenyans utilize savings accounts, regardless of sex or location",
subtitle = "Proportion of individuals with particular financial products by sex and area",
caption = "Source Financial Access Survey, Kenya"
)
finac.k %>%
group_by(cluster_type, gender_of_respondent) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE)) %>%
gather("bank", "sacco", "micro", "savings", key = "product", value = "proportion") %>%
unite(sex_area, cluster_type, gender_of_respondent) %>%
ggplot(aes(x = product, y = as.factor(sex_area), fill = proportion)) +
geom_tile(color = "white", size = 0.25) +
labs(
title = "Most Kenyans utilize savings accounts, regardless of sex or location",
subtitle = "Proportion of individuals with particular financial products by sex and area",
caption = "Source Financial Access Survey, Kenya"
y = NULL
x = NULL
)
group_by(cluster_type, gender_of_respondent) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE)) %>%
gather("bank", "sacco", "micro", "savings", key = "product", value = "proportion") %>%
unite(sex_area, cluster_type, gender_of_respondent) %>%
ggplot(aes(x = product, y = as.factor(sex_area), fill = proportion)) +
geom_tile(color = "white", size = 0.25) +
labs(
title = "Most Kenyans utilize savings accounts, regardless of sex or location",
subtitle = "Proportion of individuals with particular financial products by sex and area",
caption = "Source Financial Access Survey, Kenya",
y = NULL,
x = NULL
)
finac.k %>%
group_by(cluster_type, gender_of_respondent) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE)) %>%
gather("bank", "sacco", "micro", "savings", key = "product", value = "proportion") %>%
unite(sex_area, cluster_type, gender_of_respondent) %>%
ggplot(aes(x = product, y = as.factor(sex_area), fill = proportion)) +
geom_tile(color = "white", size = 0.25) +
labs(
title = "Most Kenyans utilize savings accounts, regardless of sex or location",
subtitle = "Proportion of individuals with particular financial products by sex and area",
caption = "Source Financial Access Survey, Kenya",
y = NULL,
x = NULL
)
remove(x)
finac.k %>%
group_by(cluster_type, gender_of_respondent) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE)) %>%
gather("bank", "sacco", "micro", "savings", key = "product", value = "proportion") %>%
unite(sex_area, cluster_type, gender_of_respondent) %>%
class(sex_area)
finac.k %>%
group_by(cluster_type, gender_of_respondent) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE)) %>%
gather("bank", "sacco", "micro", "savings", key = "product", value = "proportion") %>%
unite(sex_area, cluster_type, gender_of_respondent) %>%
class(sex_area)
finac.k %>%
group_by(cluster_type, gender_of_respondent) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE)) %>%
gather("bank", "sacco", "micro", "savings", key = "product", value = "proportion") %>%
unite(sex_area, cluster_type, gender_of_respondent)
finac.k %>%
group_by(cluster_type, gender_of_respondent) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE)) %>%
gather("bank", "sacco", "micro", "savings", key = "product", value = "proportion") %>%
unite(sex_area, cluster_type, gender_of_respondent) %>%
mutate(sex_area = factor(sex_area))
finac.k %>%
group_by(cluster_type, gender_of_respondent) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE)) %>%
gather("bank", "sacco", "micro", "savings", key = "product", value = "proportion") %>%
unite(sex_area, cluster_type, gender_of_respondent) %>%
mutate(sex_area = factor(sex_area)) %>%
levels(sex_area)
finac.k %>%
group_by(cluster_type, gender_of_respondent) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE)) %>%
gather("bank", "sacco", "micro", "savings", key = "product", value = "proportion") %>%
unite(sex_area, cluster_type, gender_of_respondent) %>%
mutate(sex_area = factor(sex_area)) %>%
levels(sex_area)
finac.k %>%
group_by(cluster_type, gender_of_respondent) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE)) %>%
gather("bank", "sacco", "micro", "savings", key = "product", value = "proportion") %>%
unite(sex_area, cluster_type, gender_of_respondent) %>%
mutate(sex_area = factor(sex_area)) %>%
levels(,sex_area)
class(finac.k$urban)
finac.k %>%
group_by(cluster_type, gender_of_respondent) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE)) %>%
gather("bank", "sacco", "micro", "savings", key = "product", value = "proportion") %>%
unite(area_sex, cluster_type, gender_of_respondent) %>%
mutate(area_sex = factor(area_sex)) %>%
revalue(area_sex, c("1_1" = "Rural male", "1_2" = "Rural female", "2_1" = "Urban male", "2_2" = "Urban female")) %>%
ggplot(aes(x = product, y = area_sex, fill = proportion)) +
geom_tile(color = "white", size = 0.25) +
labs(
title = "Most Kenyans utilize savings accounts, regardless of sex or location",
subtitle = "Proportion of individuals with particular financial products by sex and area",
caption = "Source Financial Access Survey, Kenya",
y = NULL,
x = NULL
)
finac.k %>%
group_by(cluster_type, gender_of_respondent) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE)) %>%
gather("bank", "sacco", "micro", "savings", key = "product", value = "proportion") %>%
unite(area_sex, cluster_type, gender_of_respondent) %>%
mutate(area_sex = as.factor(area_sex)) %>%
mutate(area_sex = fct_relevel(area_sex, "1_1" = "Rural male", "1_2" = "Rural female", "2_1" = "Urban male", "2_2" = "Urban female")) %>%
ggplot(aes(x = product, y = area_sex, fill = proportion)) +
geom_tile(color = "white", size = 0.25) +
labs(
title = "Most Kenyans utilize savings accounts, regardless of sex or location",
subtitle = "Proportion of individuals with particular financial products by sex and area",
caption = "Source Financial Access Survey, Kenya",
y = NULL,
x = NULL
)
?revalue
finac.k %>%
group_by(cluster_type, gender_of_respondent) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE)) %>%
gather("bank", "sacco", "micro", "savings", key = "product", value = "proportion") %>%
unite(area_sex, cluster_type, gender_of_respondent) %>%
mutate(area_sex = as.factor(area_sex)) %>%
mutate(area_sex = revalue(area_sex, c("1_1" = "Rural male", "1_2" = "Rural female", "2_1" = "Urban male", "2_2" = "Urban female")) %>%
ggplot(aes(x = product, y = area_sex, fill = proportion)) +
geom_tile(color = "white", size = 0.25) +
labs(
title = "Most Kenyans utilize savings accounts, regardless of sex or location",
subtitle = "Proportion of individuals with particular financial products by sex and area",
caption = "Source Financial Access Survey, Kenya",
y = NULL,
x = NULL
)
finac.k %>%
group_by(cluster_type, gender_of_respondent) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE)) %>%
gather("bank", "sacco", "micro", "savings", key = "product", value = "proportion") %>%
unite(area_sex, cluster_type, gender_of_respondent) %>%
mutate(area_sex = as.factor(area_sex)) %>%
mutate(area_sex = revalue(area_sex, c("1_1" = "Rural male", "1_2" = "Rural female", "2_1" = "Urban male", "2_2" = "Urban female")) %>%
ggplot(aes(x = product, y = area_sex, fill = proportion)) +
geom_tile(color = "white", size = 0.25) +
labs(
title = "Most Kenyans utilize savings accounts, regardless of sex or location",
subtitle = "Proportion of individuals with particular financial products by sex and area",
caption = "Source Financial Access Survey, Kenya",
y = NULL,
x = NULL
)
finac.k %>%
group_by(cluster_type, gender_of_respondent) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE)) %>%
gather("bank", "sacco", "micro", "savings", key = "product", value = "proportion") %>%
unite(area_sex, cluster_type, gender_of_respondent) %>%
mutate(area_sex = as.factor(area_sex)) %>%
mutate(area_sex = revalue(area_sex, c("1_1" = "Rural male", "1_2" = "Rural female", "2_1" = "Urban male", "2_2" = "Urban female"))) %>%
ggplot(aes(x = product, y = area_sex, fill = proportion)) +
geom_tile(color = "white", size = 0.25) +
labs(
title = "Most Kenyans utilize savings accounts, regardless of sex or location",
subtitle = "Proportion of individuals with particular financial products by sex and area",
caption = "Source Financial Access Survey, Kenya",
y = NULL,
x = NULL
)
library(plyr)
finac.k %>%
group_by(cluster_type, gender_of_respondent) %>%
summarize(bank = mean(e4_1, na.rm = TRUE),
sacco = mean(e4_3, na.rm = TRUE),
micro = mean(e4_4, na.rm = TRUE),
savings = mean(e4_5, na.rm = TRUE)) %>%
gather("bank", "sacco", "micro", "savings", key = "product", value = "proportion") %>%
unite(area_sex, cluster_type, gender_of_respondent) %>%
mutate(area_sex = as.factor(area_sex)) %>%
mutate(area_sex = revalue(area_sex, c("1_1" = "Rural male", "1_2" = "Rural female", "2_1" = "Urban male", "2_2" = "Urban female"))) %>%
ggplot(aes(x = product, y = area_sex, fill = proportion)) +
geom_tile(color = "white", size = 0.25) +
labs(
title = "Most Kenyans utilize savings accounts, regardless of sex or location",
subtitle = "Proportion of individuals with particular financial products by sex and area",
caption = "Source Financial Access Survey, Kenya",
y = NULL,
x = NULL
)
