select(type, pct.f, pct.m, total1, total2) %>%
gather(pct.f, pct.m, key = "Sex", value = "pct") %>%
gather(total1, total2, key = "Sex2", value = "total") %>%
print (n = 60)
finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n()) %>%
summarize(total1 = sum(n[gender_of_respondent==1]), total2 = sum(n[gender_of_respondent==2])) %>%
mutate(male = sum(total1), female = sum(total2), pct.m = (total1/male)*100, pct.f = (total2/female)*100) %>%
#  gather(total1, total2, pct.m, pct.f, key = "Sex", value = "pct")
select(type, pct.f, pct.m, total1, total2) %>%
gather(pct.f, pct.m, key = "Sex", value = "pct") %>%
gather(total1, total2, key = "Sex2", value = "total") %>%
[(., 1:15, 31:45])
finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n()) %>%
summarize(total1 = sum(n[gender_of_respondent==1]), total2 = sum(n[gender_of_respondent==2])) %>%
mutate(male = sum(total1), female = sum(total2), pct.m = (total1/male)*100, pct.f = (total2/female)*100) %>%
#  gather(total1, total2, pct.m, pct.f, key = "Sex", value = "pct")
select(type, pct.f, pct.m, total1, total2) %>%
gather(pct.f, pct.m, key = "Sex", value = "pct") %>%
gather(total1, total2, key = "Sex2", value = "total")
## Tree map
finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n()) %>%
summarize(total1 = sum(n[gender_of_respondent==1]), total2 = sum(n[gender_of_respondent==2])) %>%
mutate(male = sum(total1), female = sum(total2), pct.m = (total1/male)*100, pct.f = (total2/female)*100) %>%
#  gather(total1, total2, pct.m, pct.f, key = "Sex", value = "pct")
select(type, pct.f, pct.m, total1, total2) %>%
gather(pct.f, pct.m, key = "Sex", value = "pct") %>%
gather(total1, total2, key = "Sex2", value = "total") %>%
"["(., 1:15, 31:45])
## Tree map
finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n()) %>%
summarize(total1 = sum(n[gender_of_respondent==1]), total2 = sum(n[gender_of_respondent==2])) %>%
mutate(male = sum(total1), female = sum(total2), pct.m = (total1/male)*100, pct.f = (total2/female)*100) %>%
#  gather(total1, total2, pct.m, pct.f, key = "Sex", value = "pct")
select(type, pct.f, pct.m, total1, total2) %>%
gather(pct.f, pct.m, key = "Sex", value = "pct") %>%
gather(total1, total2, key = "Sex2", value = "total") %>%
"["(, 1:15, 31:45])
## Tree map
finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n()) %>%
summarize(total1 = sum(n[gender_of_respondent==1]), total2 = sum(n[gender_of_respondent==2])) %>%
mutate(male = sum(total1), female = sum(total2), pct.m = (total1/male)*100, pct.f = (total2/female)*100) %>%
#  gather(total1, total2, pct.m, pct.f, key = "Sex", value = "pct")
select(type, pct.f, pct.m, total1, total2) %>%
gather(pct.f, pct.m, key = "Sex", value = "pct") %>%
gather(total1, total2, key = "Sex2", value = "total") %>%
"["(, 1:15, 31:45)
finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n()) %>%
summarize(total1 = sum(n[gender_of_respondent==1]), total2 = sum(n[gender_of_respondent==2])) %>%
mutate(male = sum(total1), female = sum(total2), pct.m = (total1/male)*100, pct.f = (total2/female)*100)
finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n()) %>%
summarize(total1 = sum(n[gender_of_respondent==1]), total2 = sum(n[gender_of_respondent==2])) %>%
mutate(male = sum(total1), female = sum(total2), pct.m = (total1/male)*100, pct.f = (total2/female)*100) %>%
#  gather(total1, total2, pct.m, pct.f, key = "Sex", value = "pct")
select(type, pct.f, pct.m, total1, total2) %>%
gather(pct.f, pct.m, key = "Sex", value = "pct")
finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n())
finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n()) %>%
summarize(total1 = sum(n[gender_of_respondent==1]), total2 = sum(n[gender_of_respondent==2])) %>%
mutate(male = sum(total1), female = sum(total2), pct.m = (total1/male)*100, pct.f = (total2/female)*100)
finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n()) %>%
summarize(total1 = sum(n[gender_of_respondent==1]), total2 = sum(n[gender_of_respondent==2])) %>%
mutate(male = sum(total1), female = sum(total2), pct.m = (total1/male)*100, pct.f = (total2/female)*100) %>%
gather(pct.f, pct.m, key = "Sex", value = "pct")
test< - finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n()) %>%
summarize(total1 = sum(n[gender_of_respondent==1]), total2 = sum(n[gender_of_respondent==2])) %>%
mutate(male = sum(total1), female = sum(total2), pct.m = (total1/male)*100, pct.f = (total2/female)*100) %>%
gather(pct.f, pct.m, key = "Sex", value = "pct") %>%
mutate(label = paste0(type, ": ", round(pct, 1), "%"))
finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n()) %>%
summarize(total1 = sum(n[gender_of_respondent==1]), total2 = sum(n[gender_of_respondent==2])) %>%
mutate(male = sum(total1), female = sum(total2), pct.m = (total1/male)*100, pct.f = (total2/female)*100) %>%
gather(pct.f, pct.m, key = "Sex", value = "pct") %>%
mutate(label = paste0(type, ": ", round(pct, 1), "%"))
finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n()) %>%
summarize(total1 = sum(n[gender_of_respondent==1]), total2 = sum(n[gender_of_respondent==2])) %>%
mutate(male = sum(total1), female = sum(total2), pct.m = (total1/male)*100, pct.f = (total2/female)*100) %>%
gather(pct.f, pct.m, key = "Sex", value = "pct") %>%
mutate(label = paste0(type, ": ", round(pct, 1), "%")) %>%
select(type, Sex, label)
finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n())
## Tree map (Sex: 1 = Male, 2 = Female)
test< - finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n()) %>%
summarize(total1 = sum(n[gender_of_respondent==1]), total2 = sum(n[gender_of_respondent==2])) %>%
mutate(male = sum(total1), female = sum(total2), pct.m = (total1/male)*100, pct.f = (total2/female)*100) %>%
gather(pct.f, pct.m, key = "Sex", value = "pct") %>%
mutate(label = paste0(type, ": ", round(pct, 1), "%")) %>%
select(type, Sex, label)
test$Sex[Sex=="pct.f"] <- 2
test$Sex[Sex=="pct.m"] <- 1
test <- finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n()) %>%
summarize(total1 = sum(n[gender_of_respondent==1]), total2 = sum(n[gender_of_respondent==2])) %>%
mutate(male = sum(total1), female = sum(total2), pct.m = (total1/male)*100, pct.f = (total2/female)*100) %>%
gather(pct.f, pct.m, key = "Sex", value = "pct") %>%
mutate(label = paste0(type, ": ", round(pct, 1), "%")) %>%
select(type, Sex, label)
test$Sex[Sex=="pct.f"] <- 2
test$Sex[Sex=="pct.m"] <- 1
finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n()) %>%
summarize(total1 = sum(n[gender_of_respondent==1]), total2 = sum(n[gender_of_respondent==2])) %>%
mutate(male = sum(total1), female = sum(total2), pct.m = (total1/male)*100, pct.f = (total2/female)*100) %>%
gather(pct.f, pct.m, key = "Sex", value = "pct") %>%
mutate(label = paste0(type, ": ", round(pct, 1), "%")) %>%
select(type, Sex, label)
finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n())
test <- finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n()) %>%
summarize(total1 = sum(n[gender_of_respondent==1]), total2 = sum(n[gender_of_respondent==2])) %>%
mutate(male = sum(total1), female = sum(total2), pct.m = (total1/male)*100, pct.f = (total2/female)*100) %>%
gather(pct.f, pct.m, key = "Sex", value = "pct") %>%
mutate(label = paste0(type, ": ", round(pct, 1), "%"), Sex = as.numeric(Sex)) %>%
select(type, Sex, label)
test$Sex[Sex=="pct.f"] <- 2
test$Sex[Sex=="pct.m"] <- 1
## Tree map (Sex: 1 = Male, 2 = Female)
test <- finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n()) %>%
summarize(total1 = sum(n[gender_of_respondent==1]), total2 = sum(n[gender_of_respondent==2])) %>%
mutate(male = sum(total1), female = sum(total2), pct.m = (total1/male)*100, pct.f = (total2/female)*100) %>%
gather(pct.f, pct.m, key = "Sex", value = "pct") %>%
mutate(label = paste0(type, ": ", round(pct, 1), "%")) %>%
select(type, Sex, label)
test$Sex[Sex=="pct.f"] <- "2"
test$Sex[Sex=="pct.m"] <- "1"
finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n()) %>%
summarize(total1 = sum(n[gender_of_respondent==1]), total2 = sum(n[gender_of_respondent==2])) %>%
mutate(male = sum(total1), female = sum(total2), pct.m = (total1/male)*100, pct.f = (total2/female)*100) %>%
gather(pct.f, pct.m, key = "Sex", value = "pct") %>%
mutate(label = paste0(type, ": ", round(pct, 1), "%")) %>%
select(type, Sex, label)
test$Sex[Sex=="pct.f"] <- "2"
test$Sex
test$Sex[test$Sex=="pct.f"] <- 2
test$Sex[test$Sex=="pct.m"] <- 1
finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n())
finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
rename(gender_of_respondent = "Sex")
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, Sex) %>%
summarize(n = n())
finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
rename(gender_of_respondent = "Sex")
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, Sex) %>%
summarize(n = n())
finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
rename(gender_of_respondent = "Sex") %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, Sex) %>%
summarize(n = n())
finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
rename(Sex = "gender_of_respondent") %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, Sex) %>%
summarize(n = n())
finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
rename(Sex = "gender_of_respondent") %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, Sex) %>%
summarize(n = n()) %>%
left_join(test)
test$Sex<- as.numeric(test$Sex)
finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
rename(Sex = "gender_of_respondent") %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, Sex) %>%
summarize(n = n()) %>%
left_join(test)
finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
rename(Sex = "gender_of_respondent") %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, Sex) %>%
summarize(n = n()) %>%
left_join(test) %>%
ggplot(aes(area = n, fill = as.factor(Sex), label = label, subgroup = as.factor(Sex))) +
geom_treemap(fill = "black") +
geom_treemap(aes(alpha = n)) +
geom_treemap_subgroup_border(color = "white") +
geom_treemap_text(aes(label = label),
place = "center",
grow = F,
color = "white",
min.size = 1,
reflow = TRUE,
family = "Avenir Next"
) +
scale_fill_discrete() +
theme(legend.position = "none") +
labs(title = "A majority of business owners user their own savings as start-up capital \n rather than loans",
subtitle = "   Female                                                                                                                          Male",
caption = "Source: Financial Access Survey, 2015-2016, Kenya"
) +
theme(text = element_text(family = "Avenir Next"),
plot.title = element_text(face = "bold"),
plot.subtitle = element_text(face = "italic"))
finac.k.06 <- mutate(finac.k.06, year = 2006)
finac.k.06 <- rename(finac.k.06, bank_usage = "A4", savings_usage = "X_savings", credit_usage = "X_credit", mfi_usage = "X_cur_mfi")
finac.k.15 <- mutate(finac.k.15, year = 2015)
y2006 <- finac.k.06 %>%
select(year, bank_usage, savings_usage, credit_usage, mfi_usage)
y2015 <- finac.k.15 %>%
select(year, bank_usage, savings_usage, credit_usage, mfi_usage)
combine <-bind_rows(y2006, y2015)
combine <- combine %>%
gather(bank_usage, savings_usage, credit_usage, mfi_usage, key = "type", value = "value") %>%
group_by(year, type) %>%
summarize(total1 = sum(value[value==1]), total2 = n(), pct = (total1/total2)*100)
ggplot(data = combine, aes(x = year, y = pct, group = type)) +
geom_line(aes(color = type, alpha = 1), size = 2) +
geom_point(aes(color = type, alpha = 1), size = 4) +
scale_x_continuous(name = "Year", position = "top", breaks = c(2006, 2015)) +
geom_text_repel(data = combine %>% filter(year==2006), aes(label = paste0(type, ":", round(pct, 2), "%")),
hjust = -0.1,
vjust = -1,
family = "Avenir Next",
size = 3) +
geom_text_repel(data = combine %>% filter(year==2015), aes(label = paste0(type, ":", round(pct, 2), "%")),
hjust = 1,
vjust = -1,
family = "Avenir Next",
size = 3) +
labs(
title = "Change in financial product useage",
subtitle = "What has changed",
caption = "Source: Financial Access Survey, Kenya, 2013 and 2016"
) +
theme(text = element_text(family = "Avenir Next"),
plot.title = element_text(face = "bold"),
plot.subtitle = element_text(face = "italic"),
legend.position = "none",
panel.border = element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
axis.ticks = element_blank())
library(stringr)
library(readxl)
setwd("/Users/marissablock/Documents/Data")
wdi <- read_csv("wdi/wdi.csv", na = "..",
col_types = cols(
`2013 [YR2013]` = col_number()
)
head(wdi)
tail(wdi)
# Drop last 5 rows
wdi <- head(wdi, -5)
tail(wdi)
# Extract series labels
series <- wdi %>%
select(`Series Name`, `Series Code`) %>%
unique()
series$`Series Code` <- tolower(series$`Series Code`)
# Rename variables
wdi <- rename(wdi, country = "Country Name", cntry.code = "Country Code")
# Reshape year variables to column
wdi2 <- wdi %>%
gather(`2013 [YR2013]`, `2014 [YR2014]`, `2015 [YR2015]`, `2016 [YR2016]`, `2017 [YR2017]`,
key = year, value = value)
# Drop Series Name
wdi2 <- select(wdi2, -`Series Name`)
# Reshape Series Code column to variables
wdi3 <- wdi2 %>%
spread(key = `Series Code`, value = value)
# Make year variable factor
wdi3$year <- str_sub(wdi3$year, 1, 4)
wdi3$year <- as.factor(wdi3$year)
# Drop variables with all NAs
wdi3 <- wdi3[, colSums(is.na(wdi3)) != nrow(wdi3)]
# Make variables names lowercase
colnames(wdi3) <- tolower(colnames(wdi3))
colnames(wdi3)
### Import region and income classification variables
class <- read_xls("wb_class.xls", sheet = "List of economies")
head(class)
class <- class %>%
select(X__2, X__3, X__5, X__6)
# Make first row column names
class <- class[-c(1:3), ]
class <- class[-2, ]
colnames(class) = class[1,]
class = class[-1,]
head(class)
class <- rename(class, inc.grp = "Income group", country = "Economy", cntry.code = "Code")
# Drop last 56 rows
tail(class, n = 60)
class <- head(class, -56)
tail(class)
wdi4 <- left_join(wdi3, class, by = "cntry.code")
# First, create dataframe of labels
label <- finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n()) %>%
summarize(total1 = sum(n[gender_of_respondent==1]), total2 = sum(n[gender_of_respondent==2])) %>%
mutate(male = sum(total1), female = sum(total2), pct.m = (total1/male)*100, pct.f = (total2/female)*100) %>%
gather(pct.f, pct.m, key = "Sex", value = "pct") %>%
mutate(label = paste0(type, ": ", round(pct, 1), "%")) %>%
select(type, Sex, label)
# First, create dataframe of labels
label <- finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n()) %>%
summarize(total1 = sum(n[gender_of_respondent==1]), total2 = sum(n[gender_of_respondent==2])) %>%
mutate(male = sum(total1), female = sum(total2), pct.m = (total1/male)*100, pct.f = (total2/female)*100) %>%
gather(pct.f, pct.m, key = "Sex", value = "pct") %>%
mutate(label = paste0(type, ": ", round(pct, 1), "%")) %>%
select(type, Sex, label)
# First, create dataframe of labels
label <- finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n()) %>%
summarize(total1 = sum(n[gender_of_respondent==1]), total2 = sum(n[gender_of_respondent==2])) %>%
mutate(male = sum(total1), female = sum(total2), pct.m = (total1/male)*100, pct.f = (total2/female)*100) %>%
gather(pct.f, pct.m, key = "Sex", value = "pct") %>%
mutate(label = paste0(type, ": ", round(pct, 1), "%")) %>%
select(type, Sex, label)
