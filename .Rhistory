mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, Sex) %>%
summarize(n = n()) %>% print(n = 29)
1455/2226
label <- finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n()) %>%
summarize(total1 = sum(n[gender_of_respondent==1]), total2 = sum(n[gender_of_respondent==2])) %>%
mutate(male = sum(total1), female = sum(total2), pct.m = (total1/male)*100, pct.f = (total2/female)*100) %>%
gather(pct.f, pct.m, key = "Sex", value = "pct") %>%
mutate(label = paste0(type, ": ", round(pct, 1), "%")) %>%
select(type, Sex, label)
label$Sex[label$Sex=="pct.f"] <- 2
label$Sex[label$Sex=="pct.m"] <- 1
label$Sex<- as.numeric(label$Sex)
# Now, get dataframe of counts and merge in labels
finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
rename(Sex = "gender_of_respondent") %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, Sex) %>%
summarize(n = n()) %>%
left_join(label) %>%
mutate(Sex2 = factor(Sex, levels = c("1", "2"),
labels = c("Male", "Female"))) %>%
ggplot(aes(area = n, fill = Sex2, label = label, subgroup = Sex2)) +
geom_treemap(fill = "white") +
geom_treemap(aes(alpha = n)) +
geom_treemap_subgroup_border(color = "white") +
geom_treemap_subgroup_text(color = "black", place = "bottomleft", family = "Avenir Next", fontface = "italic") +
geom_treemap_text(aes(label = label),
place = "center",
grow = F,
color = "black",
min.size = 1,
reflow = TRUE,
family = "Avenir Next"
) +
scale_fill_manual(values = c("#1b9e77", "#7570b3")) +
theme(legend.position = "none") +
labs(title = "Many business owners user their own savings as start-up capital \n rather than loans",
subtitle = "Females also receive more gifts from family or friends.\n\nIn this survey, females represent about 65% of business owners.",
caption = "Source: Financial Access Survey, 2015-2016, Kenya"
) +
theme(text = element_text(family = "Avenir Next"),
plot.title = element_text(face = "bold"),
plot.subtitle = element_text(face = "italic"))
finac.k.15 %>%
group_by(cluster_type, gender_of_respondent) %>%
summarize(Bank = mean(e4_1, na.rm = TRUE)*100,
SACCO = mean(e4_3, na.rm = TRUE)*100,
Microfinance = mean(e4_4, na.rm = TRUE)*100,
Savings = mean(e4_5, na.rm = TRUE)*100,
Loans = mean(e4_7, na.rm = TRUE)*100,
Insurance = mean(e4_9, na.rm = TRUE)*100) %>%
gather("Bank", "SACCO", "Microfinance", "Savings", "Loans", "Insurance", key = "product", value = "proportion") %>%
unite(area_sex, cluster_type, gender_of_respondent) %>%
mutate(area_sex = factor(area_sex, levels = c("1_1", "1_2", "2_1", "2_2"),
labels = c("Rural male", "Rural female", "Urban male", "Urban female"))) %>%
mutate(product = factor(product, levels = c("Savings", "Bank", "Loans", "Insurance", "SACCO", "Microfinance"))) %>%
ggplot(aes(x = product, y = area_sex, fill = proportion)) +
geom_tile(color = "black", size = 0.25) +
geom_text(aes(label = paste0(round(proportion,1), "%"), family = "Avenir Next", fontface = "bold")) +
scale_fill_gradient2(name = "Proportion", low = "#e8f5f1", mid = "#76c4ad", high = "#1b9e77", guide = "colorbar", midpoint = 40) +
#scale_fill_brewer(palette = "Dark2") +
labs(
title = "Most Kenyans utilize savings accounts, \n regardless of sex or location",
subtitle = "The proportion of individuals with particular financial products by sex and area",
caption = "Source: Financial Access Survey 2015-16, Kenya",
y = NULL,
x = NULL
) +
my.theme +
theme(panel.background = element_rect(fill = "white"),
axis.ticks = element_blank())
finac.k.15 %>%
group_by(cluster_type, gender_of_respondent) %>%
summarize(Bank = mean(e4_1, na.rm = TRUE)*100,
SACCO = mean(e4_3, na.rm = TRUE)*100,
Microfinance = mean(e4_4, na.rm = TRUE)*100,
Savings = mean(e4_5, na.rm = TRUE)*100,
Loans = mean(e4_7, na.rm = TRUE)*100,
Insurance = mean(e4_9, na.rm = TRUE)*100) %>%
gather("Bank", "SACCO", "Microfinance", "Savings", "Loans", "Insurance", key = "product", value = "proportion") %>%
unite(area_sex, cluster_type, gender_of_respondent) %>%
mutate(area_sex = factor(area_sex, levels = c("1_1", "1_2", "2_1", "2_2"),
labels = c("Rural male", "Rural female", "Urban male", "Urban female"))) %>%
mutate(product = factor(product, levels = c("Savings", "Bank", "Loans", "Insurance", "SACCO", "Microfinance"))) %>%
ggplot(aes(x = product, y = area_sex, fill = proportion)) +
geom_tile(color = "black", size = 0.25) +
geom_text(aes(label = paste0(round(proportion,1), "%"), family = "Avenir Next", fontface = "bold")) +
scale_fill_gradient2(name = "Proportion", low = "#e8f5f1", mid = "#76c4ad", high = "#1b9e77", guide = "colorbar", midpoint = 40) +
labs(
title = "Most Kenyans utilize savings accounts, \n regardless of sex or location",
subtitle = "The proportion of individuals with particular financial products by sex and area",
caption = "SACCO: Savings and Credit Cooperatives Societies\nSource: Financial Access Survey 2015-16, Kenya",
y = NULL,
x = NULL
) +
my.theme +
theme(panel.background = element_rect(fill = "white"),
axis.ticks = element_blank())
imf %>%
filter(!is.na(i_mob_transactions_value_GDP), year>2011) %>%
group_by(Region, year) %>%
summarize(mean = mean(i_mob_transactions_value_GDP, na.rm = TRUE)) %>%
mutate(Region2 = factor(Region, levels = c("Sub-Saharan Africa", "East Asia & Pacific", "South Asia", "Europe & Central Asia", "Latin America & Caribbean",
"Middle East & North Africa"))) %>%
mutate(size = ifelse(Region2=="Sub-Saharan Africa", 1, 0)) %>%
ggplot(aes(x = year, y = mean, color = Region2, size = size)) +
geom_line() +
scale_size(range = c(0.2, 0.8), guide="none") +
labs(
title = "Mobile money useage has grown significantly in Sub-Saharan Africa",
subtitle = "Wheras in Latin America and the Middle East, there has been little growth",
caption = "Source: IMF Financial Access Survey",
x = "Year",
y = "Average value of mobile money transactions (% of GDP)"
) +
scale_x_continuous(breaks = c(2012, 2013, 2014, 2015, 2016, 2017)) +
scale_color_brewer(name = NULL, palette = "Dark2") +
geom_point(size = 0.8) +
my.theme +
theme(legend.position = c(0.05, 0.97),
legend.justification = c("left", "top"),
legend.box.just = "left",
legend.margin = margin(6, 6, 6, 6),
legend.box.background = element_rect())
# Make bar plot
finac.k.15 %>%
mutate(nobank = bank_usage - 2) %>%
group_by(county) %>%
filter(nobank==1) %>%
summarize(n = n()) %>%
left_join(pop, by = "county") %>%
mutate(usepcap = (n/pop_2015)*100000) %>%
ggplot(aes(x = reorder(county, usepcap), y = (usepcap), fill = cut_number((usepcap), 4))) +
geom_bar(stat = "identity") +
scale_fill_manual(name = NULL, values = c("#a3d8c8", "#76c4ad", "#48b192", "#1b9e77"),
labels = c("Less than 25.99%", "26% - 41.3%", "41.4% - 50.5%", "50.6% or more")) +
scale_x_discrete(expand = c(0,0)) +
scale_y_continuous(expand = c(0,0))
# Create county labels
labels2 <- kenya %>%
cbind(st_coordinates(st_centroid(kenya))) %>%
filter(county=="Isiolo" | county=="Lamu" | county=="Marsabit")
labels2$county[labels2$county=="Isiolo"] <- "Isiolo, 83.7"
labels2$county[labels2$county=="Lamu"] <- "Lamu, 41.5"
labels2$county[labels2$county=="Marsabit"] <- "Marsabit, 43.9"
# Map
finac.k.15 %>%
mutate(nobank = bank_usage - 2) %>%
group_by(county) %>%
filter(nobank==1) %>%
summarize(n = n()) %>%
left_join(pop, by = "county") %>%
mutate(usepcap = (n/pop_2015)*100000) %>%
left_join(kenya, by = "county") %>%
cbind(st_coordinates(st_centroid(kenya))) %>%
mutate(density = n/Shape_Area) %>%
ggplot() +
geom_sf(aes(fill = usepcap)) +
geom_label_repel(data = labels2, aes(X, Y, label = county), size = 3, family = "Avenir Next") +
coord_sf(datum=NA) +
scale_fill_distiller(name = NULL, palette = "Greens", direction = 1) +
theme(panel.background = element_blank(),
text = element_text(family = "Avenir Next"),
plot.title = element_text(face = "bold"),
plot.subtitle = element_text(face = "italic"),
axis.title = element_blank()) +
labs(title = "Individuals who have never banked are \nconcentrated in three counties",
subtitle = "Individuals who never banked per 100,000 in 2015",
caption = "Source: 2015-16 Financial Access Survey \n Population data is a projection from UNICEF")
# First, create dataframe of labels
label <- finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n()) %>%
summarize(total1 = sum(n[gender_of_respondent==1]), total2 = sum(n[gender_of_respondent==2])) %>%
mutate(male = sum(total1), female = sum(total2), pct.m = (total1/male)*100, pct.f = (total2/female)*100) %>%
gather(pct.f, pct.m, key = "Sex", value = "pct") %>%
mutate(label = paste0(type, ": ", round(pct, 1), "%")) %>%
select(type, Sex, label)
label$Sex[label$Sex=="pct.f"] <- 2
label$Sex[label$Sex=="pct.m"] <- 1
label$Sex<- as.numeric(label$Sex)
# Now, get dataframe of counts and merge in labels
finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
rename(Sex = "gender_of_respondent") %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, Sex) %>%
summarize(n = n()) %>%
left_join(label) %>%
mutate(Sex2 = factor(Sex, levels = c("1", "2"),
labels = c("Male", "Female"))) %>%
ggplot(aes(area = n, fill = Sex2, label = label, subgroup = Sex2)) +
geom_treemap(fill = "white") +
geom_treemap(aes(alpha = n)) +
geom_treemap_subgroup_border(color = "white") +
geom_treemap_subgroup_text(color = "white", place = "bottomleft", family = "Avenir Next", fontface = "italic") +
geom_treemap_text(aes(label = label),
place = "center",
grow = F,
color = "black",
min.size = 1,
reflow = TRUE,
family = "Avenir Next"
) +
scale_fill_manual(values = c("#1b9e77", "#7570b3")) +
theme(legend.position = "none") +
labs(title = "Many business owners user their own savings as start-up capital\nrather than loans",
subtitle = "Females also receive more gifts from family or friends.\n\nIn this survey, females represent about 65% of business owners.",
caption = "Source: Financial Access Survey, 2015-2016, Kenya"
) +
my.theme
# First, create dataframe of labels
label <- finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n()) %>%
summarize(total1 = sum(n[gender_of_respondent==1]), total2 = sum(n[gender_of_respondent==2])) %>%
mutate(male = sum(total1), female = sum(total2), pct.m = (total1/male)*100, pct.f = (total2/female)*100) %>%
gather(pct.f, pct.m, key = "Sex", value = "pct") %>%
mutate(label = paste0(type, ": ", round(pct, 1), "%")) %>%
select(type, Sex, label)
label$Sex[label$Sex=="pct.f"] <- 2
label$Sex[label$Sex=="pct.m"] <- 1
label$Sex<- as.numeric(label$Sex)
# Now, get dataframe of counts and merge in labels
finac.k.15 %>%
filter(l5_1!="NA", l5_1<995) %>%
rename(Sex = "gender_of_respondent") %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, Sex) %>%
summarize(n = n()) %>%
left_join(label) %>%
mutate(Sex2 = factor(Sex, levels = c("1", "2"),
labels = c("Male", "Female"))) %>%
ggplot(aes(area = n, fill = Sex2, label = label, subgroup = Sex2)) +
geom_treemap(fill = "white") +
geom_treemap(aes(alpha = n)) +
geom_treemap_subgroup_border(color = "white") +
geom_treemap_subgroup_text(color = "white", place = "bottomleft", family = "Avenir Next", fontface = "italic") +
geom_treemap_text(aes(label = label),
place = "center",
grow = F,
color = "black",
min.size = 1,
reflow = TRUE,
family = "Avenir Next"
) +
scale_fill_manual(values = c("#1b9e77", "#7570b3")) +
theme(legend.position = "none") +
labs(title = "Many business owners user their own savings as start-up capital\nrather than loans",
subtitle = "Females also receive more gifts from family or friends.\n\nIn this survey, females represent about 65% of business owners.",
caption = "Source: Financial Access Survey, 2015-2016, Kenya"
) +
my.theme
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library(tidyverse)
library(here)
library(treemapify)
library(RColorBrewer)
library(haven)
library(readxl)
library(sf)
library(extrafont)
library(ggrepel)
library(ggridges)
library(waffle)
# Load data
findex <- read_csv("../fininc-data/clean/clean.findex.csv")
imf <- read_csv("../fininc-data/clean/clean.imf.csv")
finac.k.15 <- read_csv("../fininc-data/clean/clean.finac.k.15.csv")
finac.k.13 <- read_csv("../fininc-data/clean/clean.finac.k.13.csv")
finac.k.06 <- read_csv("../fininc-data/clean/clean.finac.k.06.csv")
wdi <- read_csv("../fininc-data/clean/clean.wdi.csv")
pop <- read_csv("../fininc-data/clean/clean.pop.csv")
# Get geospatial data
kenya <- read_sf(dsn="../fininc-data/ken_admbnda_adm1_iebc_20180607", layer = "ken_admbnda_adm1_iebc_20180607")
# Cut excess variables
kenya <- kenya %>%
select(Shape_Leng, Shape_Area, ADM1_EN, geometry) %>%
rename(county = "ADM1_EN")
# Project data
kenya <- st_transform(kenya, 21097)
africa <- read_sf(dsn="../fininc-data/countries", layer = "ne_50m_admin_0_countries")
africa <- africa %>%
filter(CONTINENT == "Africa") %>%
rename(cntry.code = "ISO_A3")
# Define theme
my.theme <-
theme(text = element_text(family = "Avenir Next"),
plot.title = element_text(face = "bold"),
plot.subtitle = element_text(face = "italic"),
panel.grid.minor = element_blank(),
panel.grid = element_line(linetype = "solid", size = 0.3)
)
# Define colors - 6-class Dark2 theme from ColorBrewer2.0
cols <- c("#1b9e77", "#d95f02", "#7570b3", "#e7298a", "#66a61e", "#e6ab02")
imf %>%
filter(!is.na(i_mob_transactions_value_GDP), year>2011) %>%
group_by(Region, year) %>%
summarize(mean = mean(i_mob_transactions_value_GDP, na.rm = TRUE)) %>%
mutate(Region2 = factor(Region, levels = c("Sub-Saharan Africa", "East Asia & Pacific", "South Asia", "Europe & Central Asia", "Latin America & Caribbean",
"Middle East & North Africa"))) %>%
mutate(size = ifelse(Region2=="Sub-Saharan Africa", 1, 0)) %>%
ggplot(aes(x = year, y = mean, color = Region2, size = size)) +
geom_line() +
scale_size(range = c(0.2, 0.8), guide="none") +
labs(
title = "Mobile money useage has grown significantly in Sub-Saharan Africa",
subtitle = "Wheras in Latin America and the Middle East, there has been little growth",
caption = "Source: IMF Financial Access Survey",
x = "Year",
y = "Average value of mobile money transactions (% of GDP)"
) +
scale_x_continuous(breaks = c(2012, 2013, 2014, 2015, 2016, 2017)) +
scale_color_brewer(name = NULL, palette = "Dark2") +
geom_point(size = 0.8) +
my.theme +
theme(legend.position = c(0.05, 0.97),
legend.justification = c("left", "top"),
legend.box.just = "left",
legend.margin = margin(6, 6, 6, 6),
legend.box.background = element_rect())
# Create dataframe of labels - MDG, TLS, BRA, QAT, SGP, KWT, BRN, ARG, SUR
labels.bubble <-   wdi %>%
filter(year==2016, cntry.code!="SSD") %>%
select(cntry.code, year, ny.gdp.pcap.kd, fr.inr.rinr) %>%
left_join(imf) %>%
select(cntry.code, economy, year, ny.gdp.pcap.kd, fr.inr.rinr, i_depositors_A1_pop, i_deposit_acc_A1_pop, Region) %>%
filter(!is.na(fr.inr.rinr)) %>%
filter(cntry.code %in% c("MDG", "TLS", "BRA", "QAT", "SGP", "KWT", "BRN", "ARG", "SUR", "BWA"))
wdi %>%
filter(year==2016) %>%
select(cntry.code, year, ny.gdp.pcap.kd, fr.inr.rinr) %>%
left_join(imf) %>%
select(cntry.code, year, ny.gdp.pcap.kd, fr.inr.rinr, i_depositors_A1_pop, i_deposit_acc_A1_pop, Region) %>%
filter(!is.na(fr.inr.rinr) & !is.na(ny.gdp.pcap.kd) & !is.na(i_depositors_A1_pop)) %>%
ggplot(aes(x = ny.gdp.pcap.kd, y = fr.inr.rinr, size = i_depositors_A1_pop)) +
geom_point(alpha = 0.5, color = "#1b9e77") +
scale_size_continuous(name = "# of Depositors per\n1,000 adults", range = c(0, 8)) +
scale_x_continuous(labels = scales::comma) +
geom_label_repel(data = labels.bubble, aes(label = economy), family = "Avenir Next", size = 3,
show.legend = FALSE, angle = 30, nudge_x = 0.2, box.padding = 0.5) +
labs(
title = "Low savings does not necessarily translate into a high interest rate",
subtitle = "As measured by the real interest rate, GDP per capita, 2016",
caption = "Source: World Development Indicators, IMF Financial Access Survey, 2016",
y = "Real Interest Rate (%)",
x = "GDP per capita, (constant 2010 US$)"
) +
my.theme +
theme(legend.position = c(0.65, 0.97),
legend.justification = c("left", "top"),
legend.box.just = "left",
legend.margin = margin(6, 6, 6, 6),
legend.box.background = element_rect()) +
annotate("rect", xmin = 0, xmax = 20000, ymin = 38, ymax = 55, alpha = 0.15) +
annotate("text", x = 17000, y = 50, label = "High cost of finance", family = "Avenir Next") +
annotate("rect", xmin = 1000, xmax = 16000, ymin = -18, ymax = -2, alpha = 0.15) +
annotate("text", x = 18000, y = -15, label = "Low cost of finance", family = "Avenir Next")
# Countries with GDP < $20,000
# Create dataframe of labels - MDG, TLS, BRA, QAT, SGP, KWT, BRN, ARG, SUR
labels.bubble2 <-   wdi %>%
filter(year==2016, cntry.code!="SSD") %>%
select(cntry.code, year, ny.gdp.pcap.kd, fr.inr.rinr) %>%
left_join(imf) %>%
select(cntry.code, economy, year, ny.gdp.pcap.kd, fr.inr.rinr, i_depositors_A1_pop, i_deposit_acc_A1_pop, Region) %>%
filter(!is.na(fr.inr.rinr)) %>%
filter(cntry.code %in% c("MDG", "TLS", "BRA", "ARG", "SUR", "BWA", "CHN", "UGA", "KGZ"))
wdi %>%
filter(year==2016, ny.gdp.pcap.kd<20000) %>%
select(cntry.code, year, ny.gdp.pcap.kd, fr.inr.rinr) %>%
left_join(imf) %>%
select(cntry.code, year, ny.gdp.pcap.kd, fr.inr.rinr, i_depositors_A1_pop, i_deposit_acc_A1_pop, Region) %>%
filter(!is.na(fr.inr.rinr) & !is.na(ny.gdp.pcap.kd) & !is.na(i_depositors_A1_pop)) %>%
ggplot(aes(x = ny.gdp.pcap.kd, y = fr.inr.rinr, size = i_depositors_A1_pop)) +
geom_point(alpha = 0.5, color = "#1b9e77") +
scale_size_continuous(name = "# of Depositors per \n1,000 adults", range = c(0, 8)) +
scale_x_continuous(labels = scales::comma) +
geom_label_repel(data = labels.bubble2, aes(label = economy), family = "Avenir Next", size = 3,
show.legend = FALSE, angle = 30, nudge_x = 0.2, box.padding = 0.5) +
labs(
title = "A Closer Look at economies with GDP per capita <$20,000",
subtitle = "As measured by the real interest rate, GDP per capita",
caption = "Source: World Development Indicators, IMF Financial Access Survey, 2016",
y = "Real Interest Rate (%)",
x = "GDP per capita, (constant 2010 US$)"
) +
my.theme +
theme(legend.position = c(0.77, 0.97),
legend.justification = c("left", "top"),
legend.box.just = "left",
legend.margin = margin(6, 6, 6, 6),
legend.box.background = element_rect())
# Make bar plot
findex %>%
filter(year==2017 & region=="Sub-Saharan Africa (excluding high income)") %>%
select(country, account.t.d) %>%
ggplot(aes(x = reorder(country, account.t.d), y = (account.t.d*100), fill = cut_number((account.t.d*100), 4))) +
geom_bar(stat = "identity") +
scale_fill_manual(name = NULL, values = c("#a3d8c8", "#76c4ad", "#48b192", "#1b9e77"),
labels = c("Less than 25.99%", "26% - 41.3%", "41.4% - 50.5%", "50.6% or more")) +
scale_x_discrete(expand = c(0,0)) +
scale_y_continuous(expand = c(0,0)) +
labs(
x = NULL,
y = "% of respondents with a financial account (Age +15)"
) +
my.theme +
theme(axis.text.x = element_text(angle = 90, hjust = 1),
axis.line.x.bottom = element_blank(),
axis.ticks.x = element_blank(),
legend.position = c(0.05, 0.97),
legend.justification = c("left", "top"),
legend.box.just = "left",
legend.margin = margin(6, 6, 6, 6),
legend.box.background = element_rect())
# Make labels
labels <- africa %>%
cbind(st_coordinates(st_centroid(africa))) %>%
filter(ADMIN=="Kenya" | ADMIN=="Namibia" | ADMIN=="South Africa" | ADMIN=="Central African Republic" | ADMIN=="Niger")
labels$ADMIN[labels$ADMIN=="Central African Republic"] <- "CAR"
# Create data frame of missing countries from Findex
missing <- africa %>%
filter(ADMIN=="Sudan" | ADMIN== "Angola" | ADMIN=="eSwatini" | ADMIN=="Burundi" | ADMIN=="Gambia" | ADMIN=="Guinea-Bissau" | ADMIN=="Equatorial Guinea" | ADMIN=="Western Sahara" | ADMIN=="Somalia" | ADMIN=="Somaliland" | ADMIN=="Eritrea") %>%
select(ADMIN, geometry, cntry.code) %>%
mutate(account.t.d = NA)
# Map
africa %>%
left_join(findex, by = "cntry.code") %>%
filter(year==2017 & region=="Sub-Saharan Africa (excluding high income)" | region=="Middle East & North Africa (excluding high income)") %>%
select(cntry.code, geometry, account.t.d, ADMIN) %>%
rbind(missing) %>%
st_as_sf() %>%
ggplot() +
geom_sf(aes(fill = cut_number(account.t.d, 4)), size = 0.2, color = "black") +
geom_label_repel(data = labels, aes(X, Y, label = ADMIN), family = "Avenir Next", size = 3) +
coord_sf(datum=NA) +
scale_fill_manual(name = NULL, values = c("#a3d8c8", "#76c4ad", "#48b192", "#1b9e77"), na.value = "grey",
labels = c("Less than 25.99%", "26% - 41.3%", "41.4% - 50.5%", "50.6% or more")) +
my.theme +
theme(panel.background = element_blank(),
axis.title = element_blank(),
legend.position = "bottom", legend.direction = "horizontal",
plot.margin =
) +
labs(
title = "Kenya, Namibia, and South Africa have the highest \nproportion of the population having a financial account",
subtitle = "Whereas financial access is low in Niger and \nthe Central African Republic (CAR)",
caption = "Source: Global Findex, 2017\nMap is from https://www.naturalearthdata.com/")
findex %>%
filter(year == 2017, region=="Sub-Saharan Africa (excluding high income)") %>%
select(country, mobileaccount.t.d.1, mobileaccount.t.d.2) %>%
filter(!is.na(mobileaccount.t.d.1)) %>%
arrange(mobileaccount.t.d.2) %>%
mutate(country = factor(country, country), mobileaccount.t.d.1 = mobileaccount.t.d.1*100,
mobileaccount.t.d.2 = mobileaccount.t.d.2*100) %>%
ggplot() +
geom_segment(aes(x=country, xend = country, y = mobileaccount.t.d.2,
yend = mobileaccount.t.d.1), color = "black") +
geom_point(aes(x = country, y = mobileaccount.t.d.2), color = "#7570b3", size = 2) +
geom_point(aes(x = country, y = mobileaccount.t.d.1), color = "#1b9e77", size = 2) +
geom_text(aes(x = "Kenya", y = 65, label = "Female"), nudge_x = -0.7, nudge_y = 0.9,
color = "black", size = 3, family = "Avenir Next", angle = 20) +
geom_text(aes(x = "Kenya", y = 78, label = "Male"), nudge_x = -0.7,
color = "black", size = 3, family = "Avenir Next", angle = 20) +
coord_flip() +
labs(
title = "While Africa leads the way in mobile money access, in almost all countries, a higher proportion
of males have mobile money accounts",
subtitle = "Gender Difference in Mobile Money Access, 2017",
caption = "Note: Excludes South Sudan and Central Africa Republic, for which there is no data.
Source: Global Findex, 2017",
y = "% of respondents with mobile money accounts (Age +15)",
x = NULL
) +
scale_y_continuous(breaks = c(0, 10, 20, 30, 40, 50, 60, 70, 80)) +
my.theme +
annotate("rect", xmin = 25, xmax = 31, ymin = 61, ymax = 83, alpha = 0.15) +
annotate("text", x = 28, y = 62, label = "M-Pesa, the leading mobile-money\nservice, was first introduced\nin Kenya in 2007. Since then, mobile\nmoney adoption in Kenya has\nfar exceeded other African countries.",
family = "Avenir Next", size = 3, hjust = 0) +
annotate("text", x = 26, y = 2, label = "In Lesotho, more females utilize\nmobile banking than males.",
family = "Avenir Next", size = 3, hjust = 0)
