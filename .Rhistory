mutate(area_sex = factor(area_sex, levels = c("1_1", "1_2", "2_1", "2_2"),
labels = c("Rural male", "Rural female", "Urban male", "Urban female"))) %>%
ggplot(aes(x = product, y = area_sex, fill = proportion)) +
geom_tile(color = "black", size = 0.25) +
geom_text(aes(label = paste0(round(proportion,1), "%"))) +
scale_fill_gradient2(name = "Proportion") +
labs(
title = "Most Kenyans utilize savings accounts, regardless of sex or location",
subtitle = "The proportion of individuals with particular financial products by sex and area",
caption = "Source: Financial Access Survey, Kenya",
y = NULL,
x = NULL
) +
theme(text = element_text(family = "Avenir Next"),
plot.title = element_text(face = "bold"),
plot.subtitle = element_text(face = "italic"))
finac.k.16 %>%
filter(!is.na(l11_1)) %>%
group_by(l11_1) %>%
mutate(bank = "Account at a bank") %>%
ggplot(aes(x = as.factor(bank), fill = as.factor(l11_1))) +
geom_bar(position = "dodge", alpha = 0.8) +
scale_fill_brewer(palette = "Oranges", name = NULL, labels = c("Currently use", "Used to use", "Never used")) +
labs(
title = "An overwhelming majority of Kenyan business-owners have never used a bank account",
subtitle = "At least for business purposes",
caption = "Source: Financial Acces Survey, 2015-2016, Kenya",
x = NULL
) +
theme(text = element_text(family = "Avenir Next"),
plot.title = element_text(face = "bold"),
plot.subtitle = element_text(face = "italic"))
## Mobile Money in Africa
findex %>%
filter(year == 2017, region=="Sub-Saharan Africa (excluding high income)") %>%
select(country, mobileaccount.t.d.1, mobileaccount.t.d.2) %>%
filter(!is.na(mobileaccount.t.d.1)) %>%
arrange(mobileaccount.t.d.2) %>%
mutate(country = factor(country, country), mobileaccount.t.d.1 = mobileaccount.t.d.1*100,
mobileaccount.t.d.2 = mobileaccount.t.d.2*100) %>%
ggplot() +
geom_segment(aes(x=country, xend = country, y = mobileaccount.t.d.2,
yend = mobileaccount.t.d.1), color = "black") +
geom_point(aes(x = country, y = mobileaccount.t.d.2), color = "pink") +
geom_point(aes(x = country, y = mobileaccount.t.d.1), color = "blue") +
coord_flip() +
labs(
title = "Gender Differences in Mobile Money Access",
subtitle = "While Africa leads the way in mobile money access, in almost all countries, a higher proportion
of males have mobile money accounts",
caption = "Note: Excludes South Sudan and Central Africa Republic, for which there is no data.
Source: Global Findex, 2017",
y = "% of respondents with mobile money accounts (+15)",
x = NULL
) +
scale_y_continuous(breaks = c(0, 10, 20, 30, 40, 50, 60, 70, 80)) +
theme(text = element_text(family = "Avenir Next"),
plot.title = element_text(face = "bold"),
plot.subtitle = element_text(face = "italic"),
panel.grid.minor =element_blank())
## Mobile Money in Africa
findex %>%
filter(year == 2017, region=="Sub-Saharan Africa (excluding high income)") %>%
select(country, mobileaccount.t.d.1, mobileaccount.t.d.2) %>%
filter(!is.na(mobileaccount.t.d.1)) %>%
arrange(mobileaccount.t.d.2) %>%
mutate(country = factor(country, country), mobileaccount.t.d.1 = mobileaccount.t.d.1*100,
mobileaccount.t.d.2 = mobileaccount.t.d.2*100) %>%
ggplot() +
geom_segment(aes(x=country, xend = country, y = mobileaccount.t.d.2,
yend = mobileaccount.t.d.1), color = "black") +
geom_point(aes(x = country, y = mobileaccount.t.d.2), color = "pink") +
geom_point(aes(x = country, y = mobileaccount.t.d.1), color = "blue") +
coord_flip() +
labs(
title = "Gender Differences in Mobile Money Access",
subtitle = "While Africa leads the way in mobile money access, in almost all countries, a higher proportion
of males have mobile money accounts",
caption = "Note: Excludes South Sudan and Central Africa Republic, for which there is no data.
Source: Global Findex, 2017",
y = "% of respondents with mobile money accounts (+15)",
x = NULL
) +
scale_y_continuous(breaks = c(0, 10, 20, 30, 40, 50, 60, 70, 80)) +
theme(text = element_text(family = "Avenir Next"),
plot.title = element_text(face = "bold"),
plot.subtitle = element_text(face = "italic"),
panel.grid.minor.x =element_blank())
findex %>%
filter(year == 2017, region=="Sub-Saharan Africa (excluding high income)") %>%
select(country, mobileaccount.t.d.1, mobileaccount.t.d.2) %>%
filter(!is.na(mobileaccount.t.d.1)) %>%
arrange(mobileaccount.t.d.2) %>%
mutate(country = factor(country, country), mobileaccount.t.d.1 = mobileaccount.t.d.1*100,
mobileaccount.t.d.2 = mobileaccount.t.d.2*100) %>%
ggplot() +
geom_segment(aes(x=country, xend = country, y = mobileaccount.t.d.2,
yend = mobileaccount.t.d.1), color = "black") +
geom_point(aes(x = country, y = mobileaccount.t.d.2), color = "pink") +
geom_point(aes(x = country, y = mobileaccount.t.d.1), color = "blue") +
coord_flip() +
labs(
title = "Gender Differences in Mobile Money Access",
subtitle = "While Africa leads the way in mobile money access, in almost all countries, a higher proportion
of males have mobile money accounts",
caption = "Note: Excludes South Sudan and Central Africa Republic, for which there is no data.
Source: Global Findex, 2017",
y = "% of respondents with mobile money accounts (+15)",
x = NULL
) +
scale_y_continuous(breaks = c(0, 10, 20, 30, 40, 50, 60, 70, 80)) +
theme(text = element_text(family = "Avenir Next"),
plot.title = element_text(face = "bold"),
plot.subtitle = element_text(face = "italic"),
panel.grid.minor.y =element_blank())
## Mobile Money in Africa
findex %>%
filter(year == 2017, region=="Sub-Saharan Africa (excluding high income)") %>%
select(country, mobileaccount.t.d.1, mobileaccount.t.d.2) %>%
filter(!is.na(mobileaccount.t.d.1)) %>%
arrange(mobileaccount.t.d.2) %>%
mutate(country = factor(country, country), mobileaccount.t.d.1 = mobileaccount.t.d.1*100,
mobileaccount.t.d.2 = mobileaccount.t.d.2*100) %>%
ggplot() +
geom_segment(aes(x=country, xend = country, y = mobileaccount.t.d.2,
yend = mobileaccount.t.d.1), color = "black") +
geom_point(aes(x = country, y = mobileaccount.t.d.2), color = "pink") +
geom_point(aes(x = country, y = mobileaccount.t.d.1), color = "blue") +
coord_flip() +
labs(
title = "Gender Differences in Mobile Money Access",
subtitle = "While Africa leads the way in mobile money access, in almost all countries, a higher proportion
of males have mobile money accounts",
caption = "Note: Excludes South Sudan and Central Africa Republic, for which there is no data.
Source: Global Findex, 2017",
y = "% of respondents with mobile money accounts (+15)",
x = NULL
) +
scale_y_continuous(breaks = c(0, 10, 20, 30, 40, 50, 60, 70, 80)) +
theme(text = element_text(family = "Avenir Next"),
plot.title = element_text(face = "bold"),
plot.subtitle = element_text(face = "italic"),
panel.grid.minor.y =element_blank(),
panel.grid.major.y = element(blank())
## Mobile Money in Africa
findex %>%
filter(year == 2017, region=="Sub-Saharan Africa (excluding high income)") %>%
select(country, mobileaccount.t.d.1, mobileaccount.t.d.2) %>%
filter(!is.na(mobileaccount.t.d.1)) %>%
arrange(mobileaccount.t.d.2) %>%
mutate(country = factor(country, country), mobileaccount.t.d.1 = mobileaccount.t.d.1*100,
mobileaccount.t.d.2 = mobileaccount.t.d.2*100) %>%
ggplot() +
geom_segment(aes(x=country, xend = country, y = mobileaccount.t.d.2,
yend = mobileaccount.t.d.1), color = "black") +
geom_point(aes(x = country, y = mobileaccount.t.d.2), color = "pink") +
geom_point(aes(x = country, y = mobileaccount.t.d.1), color = "blue") +
coord_flip() +
labs(
title = "Gender Differences in Mobile Money Access",
subtitle = "While Africa leads the way in mobile money access, in almost all countries, a higher proportion
of males have mobile money accounts",
caption = "Note: Excludes South Sudan and Central Africa Republic, for which there is no data.
Source: Global Findex, 2017",
y = "% of respondents with mobile money accounts (+15)",
x = NULL
) +
scale_y_continuous(breaks = c(0, 10, 20, 30, 40, 50, 60, 70, 80)) +
theme(text = element_text(family = "Avenir Next"),
plot.title = element_text(face = "bold"),
plot.subtitle = element_text(face = "italic"),
panel.grid.minor.y =element_blank(),
panel.grid.major.y = element_blank())
## Mobile Money in Africa
findex %>%
filter(year == 2017, region=="Sub-Saharan Africa (excluding high income)") %>%
select(country, mobileaccount.t.d.1, mobileaccount.t.d.2) %>%
filter(!is.na(mobileaccount.t.d.1)) %>%
arrange(mobileaccount.t.d.2) %>%
mutate(country = factor(country, country), mobileaccount.t.d.1 = mobileaccount.t.d.1*100,
mobileaccount.t.d.2 = mobileaccount.t.d.2*100) %>%
ggplot() +
geom_segment(aes(x=country, xend = country, y = mobileaccount.t.d.2,
yend = mobileaccount.t.d.1), color = "black") +
geom_point(aes(x = country, y = mobileaccount.t.d.2), color = "pink") +
geom_point(aes(x = country, y = mobileaccount.t.d.1), color = "blue") +
coord_flip() +
labs(
title = "Gender Differences in Mobile Money Access",
subtitle = "While Africa leads the way in mobile money access, in almost all countries, a higher proportion
of males have mobile money accounts",
caption = "Note: Excludes South Sudan and Central Africa Republic, for which there is no data.
Source: Global Findex, 2017",
y = "% of respondents with mobile money accounts (+15)",
x = NULL
) +
scale_y_continuous(breaks = c(0, 10, 20, 30, 40, 50, 60, 70, 80)) +
theme(text = element_text(family = "Avenir Next"),
plot.title = element_text(face = "bold"),
plot.subtitle = element_text(face = "italic"),
panel.grid.minor.y =element_blank(),
panel.grid.major.y = element_blank())
geom_text?
?geom_text
## Heat Map of Demographics by Financial Product
finac.k.16 %>%
group_by(cluster_type, gender_of_respondent) %>%
summarize(bank = mean(e4_1, na.rm = TRUE)*100,
sacco = mean(e4_3, na.rm = TRUE)*100,
micro = mean(e4_4, na.rm = TRUE)*100,
savings = mean(e4_5, na.rm = TRUE)*100,
loans = mean(e4_7, na.rm = TRUE)*100,
insurance = mean(e4_9, na.rm = TRUE)*100) %>%
gather("bank", "sacco", "micro", "savings", "loans", "insurance", key = "product", value = "proportion") %>%
unite(area_sex, cluster_type, gender_of_respondent) %>%
mutate(area_sex = factor(area_sex, levels = c("1_1", "1_2", "2_1", "2_2"),
labels = c("Rural male", "Rural female", "Urban male", "Urban female"))) %>%
ggplot(aes(x = product, y = area_sex, fill = proportion)) +
geom_tile(color = "black", size = 0.25) +
geom_text(aes(label = paste0(round(proportion,1), "%"), family = "Avenir Next")) +
scale_fill_gradient2(name = "Proportion") +
labs(
title = "Most Kenyans utilize savings accounts, regardless of sex or location",
subtitle = "The proportion of individuals with particular financial products by sex and area",
caption = "Source: Financial Access Survey, Kenya",
y = NULL,
x = NULL
) +
theme(text = element_text(family = "Avenir Next"),
plot.title = element_text(face = "bold"),
plot.subtitle = element_text(face = "italic"))
finac.k.16 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n())
finac.k.16 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n()) %>%
ungroup(type) %>%
summarize(female = sum(n[gender_of_respondent==1]),
male = sum(n[gender_of_respondent==2]))
finac.k.16 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n()) %>%
ggplot(aes(area = n, fill = as.factor(gender_of_respondent), label = as.character(type), subgroup = as.factor(gender_of_respondent))) +
geom_treemap(fill = "black") +
geom_treemap(aes(alpha = n)) +
geom_treemap_subgroup_border(color = "white") +
geom_treemap_text(aes(label = type),
place = "center",
grow = F,
color = "white",
min.size = 1,
reflow = TRUE,
) +
scale_fill_discrete() +
theme(legend.position = "none") +
labs(title = "A majority of business owners user their own savings as start-up capital \n rather than loans",
subtitle = "Female                                                                                                                              Male",
caption = "Source: Financial Access Survey, 2015-2016, Kenya"
)
library(treemapify)
finac.k.16 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n()) %>%
ggplot(aes(area = n, fill = as.factor(gender_of_respondent), label = as.character(type), subgroup = as.factor(gender_of_respondent))) +
geom_treemap(fill = "black") +
geom_treemap(aes(alpha = n)) +
geom_treemap_subgroup_border(color = "white") +
geom_treemap_text(aes(label = type),
place = "center",
grow = F,
color = "white",
min.size = 1,
reflow = TRUE,
) +
scale_fill_discrete() +
theme(legend.position = "none") +
labs(title = "A majority of business owners user their own savings as start-up capital \n rather than loans",
subtitle = "Female                                                                                                                              Male",
caption = "Source: Financial Access Survey, 2015-2016, Kenya"
)
?treemapify
finac.k.16 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n())
?aggregate
finac.k.16 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n()) %>%
aggregate(n, list(gender_of_respondent), sum)
## Tree map
finac.k.16 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n()) %>%
aggregate(n, gender_of_respondent, sum)
finac.k.16 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(gender_of_respondent) %>%
mutate(n = n())
## Tree map
finac.k.16 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
group_by(gender_of_respondent) %>%
mutate(n = n()) %>%
group_by(type, gender_of_respondent) %>%
summarize(n = n())
finac.k.16 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
select(type, gender_of_respondent) %>%
mutate(totalf = count(gender_of_respondent[gender_of_respondent==1]))
finac.k.16 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
select(type, gender_of_respondent)
finac.k.16 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
select(type, gender_of_respondent) %>%
mutate(totalf = n(gender_of_respondent[gender_of_respondent==1]))
## Tree map
finac.k.16 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
select(type, gender_of_respondent) %>%
mutate(totalf = n([gender_of_respondent==1]))
## Tree map
finac.k.16 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
select(type, gender_of_respondent) %>%
mutate(totalf = sum(n([gender_of_respondent==1]))
## Tree map
finac.k.16 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
select(type, gender_of_respondent) %>%
mutate(totalf = sum(n[gender_of_respondent==1]))
class(finac.k.16$gender_of_respondent)
finac.k.16 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
select(type, gender_of_respondent)
finac.k.16 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
select(type, gender_of_respondent) %>%
summarize(totalf = sum(n[gender_of_respondent==1]))
## Tree map
finac.k.16 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
select(type, gender_of_respondent) %>%
summarize(totalf = n(gender_of_respondent==1))
## Tree map
finac.k.16 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
select(type, gender_of_respondent) %>%
summarize(totalf = n([gender_of_respondent==1]))
?n
?count
finac.k.16 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
select(type, gender_of_respondent) %>%
mutate(totalf = count(gender_of_respondent[gender_of_respondent==1]))
finac.k.16 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
select(type, gender_of_respondent) %>%
mutate(totalf = sum(gender_of_respondent[gender_of_respondent==1]))
finac.k.16 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
select(type, gender_of_respondent) %>%
mutate(totalf = sum(gender_of_respondent[gender_of_respondent==1])) %>%
totalf[gender_of_respondent==2] <- count(gender_of_respondent==2]))
## Tree map
finac.k.16 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
select(type, gender_of_respondent) %>%
mutate(totalf = sum(gender_of_respondent[gender_of_respondent==1])) %>%
totalf[gender_of_respondent==2] <- count(gender_of_respondent[gender_of_respondent==2])
## Tree map
finac.k.16 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
select(type, gender_of_respondent) %>%
mutate(totalf = count(gender_of_respondent[gender_of_respondent==1]))
finac.k.16 %>%
filter(l5_1!="NA", l5_1<995) %>%
mutate(type = factor(l5_1, labels = c("Commercial bank loan", "Microfinance loan",
"SACCO loan", "Money lender", "Chama (Savings group)",
"Loan from family/friends", "Gift from family/friends", "Income from another business", "Sale of assets",
"Own savings", "Inherited", "Government fund", "Other", "Don't know", "Mobile" ))) %>%
select(type, gender_of_respondent) %>%
mutate(totalf = sum(gender_of_respondent[gender_of_respondent==1])) %>%
mutate(totalm = sum(gender_of_respondent[gender_of_respondent==2]))
## 1. Global Findex
findex <- read_xlsx("data/global_findex.xlsx", sheet = "Data",
na = "")
# Rename first columns
findex <- rename(findex, year = "X__1", cntry.code = "X__2", country = "X__3",
region = "X__4", inc.grp = "X__5")
# Check region variables
table(findex$region)
findex$country[findex$region=="i"]
findex$region[findex$country=="Afghanistan"]
findex$region[findex$region=="i"] <- "South Asia"
library(readxl)
############################# Import + Clean Data #############################
## 1. Global Findex
findex <- read_xlsx("data/global_findex.xlsx", sheet = "Data",
na = "")
# Rename first columns
findex <- rename(findex, year = "X__1", cntry.code = "X__2", country = "X__3",
region = "X__4", inc.grp = "X__5")
# Check region variables
table(findex$region)
findex$country[findex$region=="i"]
findex$region[findex$country=="Afghanistan"]
findex$region[findex$region=="i"] <- "South Asia"
